define("Models/Component",[],(function(){return function(){this.componentConfig=null,this.type=null,this.elementId=null,this.element=null,this.useComponentTemplate=!1,this.data=null,this.state=void 0,this.setComponentConfig=function(a){this.componentConfig=void 0!==a?a:null},this.setType=function(a){this.type=void 0!==a?a:null},this.setElementId=function(a){this.elementId=void 0!==a?a:this.type,this.element=document.getElementById(this.elementId)},this.setUseComponentTemplate=function(a){a=void 0===a||a,this.useComponentTemplate="boolean"!=typeof a||a},this.setData=function(a){this.data=void 0!==a?a:null},this.setState=function(a){this.state=void 0!==a?a:this.state},this.getComponentPath=function(){return null!==this.type?"Components/"+this.type+"/"+this.type:null},this.getElement=function(){return this.element},this.getDictionary=function(){if(!this.element||!this.element.hasAttribute("dictionary"))return null;try{return JSON.parse(this.element.getAttribute("dictionary"))}catch(a){return null}},this.getComponentConfig=function(){return!this.useComponentTemplate&&this.element&&(this.componentConfig.template={element:this.element}),this.componentConfig}}})),define("ProductUtils/ComponentLoader",["ko","Models/Component"],(function(a,c){return function(){this.register=function(d,ee,te){var ie=new c;return ie.setType(d.type),ie.setElementId(d.elementId),ie.setData(ee),ie.setState(te),ie.setUseComponentTemplate(d.useComponentTemplate),require([ie.getComponentPath()],(function(c){ie.setComponentConfig(c),a.components.register(d.name,ie.getComponentConfig()),null===ie.getElement()&&ie.getElement()==={}||a.applyBindingsToNode(ie.getElement(),{component:{name:d.name,params:{dictionary:ie.getDictionary(),data:ie.data,state:ie.state}}})})),ie},this.unregister=function(c){c&&0!==c.length&&a.components.isRegistered(c)&&a.components.unregister(c)}}})),define("text",{load:function(a){throw new Error("Dynamic load not allowed: "+a)}}),define("text!videoPlayerView",[],(function(){return'<div class="asos-media-players">\n    <div class="amp-video-player amp-relative">\n        <video class="amp-page amp-video-element" data-bind="foreach: sources" controls="controls" muted>\n            <source data-bind="attr: { type: type, src: src }" />\n        </video>\n        <div class="amp-page amp-page-message amp-error-page" data-bind="visible: isErrorPageVisible">\n            <div class="amp-message-container">\n                <div class="amp-message-box">\n                    <h2 data-bind="html: messages.errorHeaderText"></h2>\n                    <p data-bind="html: messages.errorMessageText"></p>\n                    <div class="amp-button amp-button-black" data-bind="html: messages.refreshButtonText, click: refreshButtonClicked"></div>\n                </div>\n            </div>\n        </div>\n        <div class="amp-page amp-page-message amp-unsupported-page" data-bind="visible: isUnsupportedPageVisible">\n            <div class="amp-message-container">\n                <div class="amp-message-box">\n                    <h2 data-bind="html: messages.unsupportedHeaderText"></h2>\n                    <p data-bind="html: messages.unsupportedMessageText"></p>\n                    <div class="amp-button amp-button-black" data-bind="html: messages.closeButtonText, click: closeButtonClicked"></div>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>'})),define("utils/scene7.config",[],(function(){"use strict";return function(a,c){this.jsonpCallback="s7jsonResponse",this.jsonpErrorCallback="s7jsonError",this.scene7imageServer=a,this.scene7videoServer=c,this.spinsetManifestFileUrlPattern=this.scene7imageServer+"/products/test-desc/[productID]-spinset",this.imageUrlPattern=this.scene7imageServer+"/products/[assetID]",this.maxImageSize={width:4e3,height:4e3},this.imageMinPartitionFactors={horizontal:3,vertical:4}}})),define("utils/scene7.DataProvider",["$"],(function(a){"use strict";var DataProvider=function(a){this.scene7config=a,this.manifestCache={}};return DataProvider.prototype.ABSOLUTE_URL_REGEX=/^https?:\/\/|^\/\//i,DataProvider.requests=[],DataProvider.prototype.getJson=function(c,d,ee){Object.prototype.hasOwnProperty.call(window,this.scene7config.jsonpErrorCallback)||(window[this.scene7config.jsonpErrorCallback]=function(a,c){var d=DataProvider.requests[c];"function"==typeof d.onError&&d.onError()}),Object.prototype.hasOwnProperty.call(window,this.scene7config.jsonpCallback)||(window[this.scene7config.jsonpCallback]=function(a,c){var d=DataProvider.requests[c];"function"==typeof d.onSuccess&&d.onSuccess(a)}),DataProvider.requests.push({onSuccess:d,onError:ee});var te=DataProvider.requests.length-1;a.ajax({url:c.replace("[requestID]",te),jsonp:!1,jsonpCallback:this.scene7config.jsonpCallback+te,dataType:"jsonp",cache:!0,success:d,error:ee})},DataProvider.prototype.getManifestData=function(c){this.ABSOLUTE_URL_REGEX.test(c)||(c="//"+c);var d=new a.Deferred;if(!this.manifestCache[c]){var ee=c+(-1===c.indexOf("?")?"?":"&")+"req=set,json&id=[requestID]";return this.getJson(ee,function(ee){this.manifestCache[c]=ee,d.resolve(a.extend(!0,{},ee))}.bind(this),(function(){d.reject()})),d.promise()}return d.resolve(a.extend(!0,{},this.manifestCache[c])),d.promise()},DataProvider})),define("videoPlayer/DataMapper",[],(function(){"use strict";var DataMapper=function(a){this.scene7config=a};return DataMapper.prototype.VIDEO_FILE_URL_PATTERN="/products/[assetID]",DataMapper.prototype.VIDEO_TYPE_FORMAT={m3u8:"application/x-mpegurl",mp4:"video/mp4"},DataMapper.prototype.map=function(a){return a.set.item.map(this.getAssetFromServerItem.bind(this))},DataMapper.prototype.getAssetFromServerItem=function(a){return{bitrate:parseInt(a.v.bitrate,10),width:parseInt(a.v.dx,10),height:parseInt(a.v.dy,10),src:this.scene7config.scene7videoServer+this.VIDEO_FILE_URL_PATTERN.replace("[assetID]",a.v.path),format:a.v.suffix,type:this.VIDEO_TYPE_FORMAT[a.v.suffix],fps:a.userdata&&a.userdata[0]&&a.userdata[0].Video_Frame_Rate?parseFloat(a.userdata[0].Video_Frame_Rate):null}},DataMapper})),define("utils/deviceHelper",[],(function(){"use strict";var DeviceHelper=function(){return this};return DeviceHelper.prototype.getScreenProperties=function(a){return{width:a.screen.width,height:a.screen.height}},DeviceHelper.prototype.isPhysicalSizeGreaterThanLogicalSize=function(a){return a&&void 0!==a.systemXDPI&&void 0!==a.logicalXDPI&&a.systemXDPI>a.logicalXDPI},DeviceHelper.prototype.getDevicePixelRatio=function(a){var c=1;return this.isPhysicalSizeGreaterThanLogicalSize(a.screen)?c=a.screen.systemXDPI/a.screen.logicalXDPI:void 0!==a.devicePixelRatio&&(c=a.devicePixelRatio),c},DeviceHelper.prototype.getWidthInPhysicalPixels=function(a){return this.getScreenProperties(a).width*this.getDevicePixelRatio(a)},DeviceHelper.prototype.getHeightInPhysicalPixels=function(a){return this.getScreenProperties(a).height*this.getDevicePixelRatio(a)},new DeviceHelper})),define("UnpatchedVideoPlayerAssetsProvider",["$","utils/deviceHelper"],(function(a,c){"use strict";var AssetsProvider=function(a,c,d){this.scene7config=a,this.dataProvider=c,this.dataMapper=d};return AssetsProvider.prototype.MANIFEST_PATH_PATTERN="/products/test-desc/[productID]-catwalk-AVS",AssetsProvider.prototype.DEFAULT_FPS=50,AssetsProvider.prototype.DEFAULT_BITRATES={480:800,720:1200,1080:2500},AssetsProvider.prototype.getAssetsByFormat=function(a,c){return a.filter((function(a){return a.format===c}))},AssetsProvider.prototype.isBetterWidthDifference=function(a,c){return 0===a||(a>0&&c<0||!(a<0&&c>0)&&Math.abs(a)<=Math.abs(c))},AssetsProvider.prototype.getBestAssetsByWidth=function(a){var d=c.getWidthInPhysicalPixels(window),ee=a[0].width,te=a[0].width-d,ie=te;return a.forEach(function(a){ie=a.width-d,this.isBetterWidthDifference(ie,te)&&(ee=a.width,te=ie)}.bind(this)),a.filter((function(a){return a.width===ee}))},AssetsProvider.prototype.getPreferredBitrateForDevice=function(a){a=a||this.DEFAULT_BITRATES;var d=Object.keys(a).map((function(a){return parseInt(a,10)})),ee=c.getWidthInPhysicalPixels(window),te=d[0],ie=d[0]-ee,ne=ie;return d.forEach((function(a){ne=a-ee,Math.abs(ne)<=Math.abs(ie)&&(te=a,ie=ne)})),1e3*a[te]},AssetsProvider.prototype.getBestAssetsByBitrate=function(a,c){var d=this.getPreferredBitrateForDevice(c),ee=a[0].bitrate,te=a[0].bitrate-d,ie=te;return a.forEach(function(a){ie=a.bitrate-d,Math.abs(ie)<=Math.abs(te)&&(ee=a.bitrate,te=ie)}.bind(this)),a.filter((function(a){return a.bitrate===ee}))},AssetsProvider.prototype.getBestAssetsByFPS=function(a,c){var d=a[0].fps,ee=a[0].fps-c,te=ee;return a.forEach(function(a){te=a.fps-c,Math.abs(te)<=Math.abs(ee)&&(d=a.fps,ee=te)}.bind(this)),a.filter((function(a){return a.fps===d}))},AssetsProvider.prototype.getBestAsset=function(a,c,d){if(a&&a.length){d=d||this.DEFAULT_FPS;var ee=this.getBestAssetsByWidth(a);if(ee.length<=1)return ee[0];var te=this.getBestAssetsByBitrate(ee,c);return te.length<=1?te[0]:this.getBestAssetsByFPS(te,d)[0]}},AssetsProvider.prototype.getBestAssets=function(a,c,d){var ee=this.getBestAssetsFromManifest(c,d);return-1!==d.formats.indexOf("m3u8")&&this.addM3U8Asset(a,ee),ee},AssetsProvider.prototype.getBestAssetsFromManifest=function(a,c){var d=[];return c.formats.forEach(function(ee){var te=this.getBestAsset(this.getAssetsByFormat(a,ee),c.preferredBitrates,c.preferredFPS);te&&d.push(te)}.bind(this)),d},AssetsProvider.prototype.addM3U8Asset=function(a,c){c.push({src:a+".m3u8",format:"m3u8",type:this.dataMapper.VIDEO_TYPE_FORMAT.m3u8})},AssetsProvider.prototype.hasAudio=function(a){return a.set.item.some(function(a){return!!a.userdata&&a.userdata.some((function(a){return!!a.Audio_Codec}))}.bind(this))},AssetsProvider.prototype.getAssets=function(a,c,d,ee){return isNaN(parseInt(a,10))||(a=this.scene7config.scene7videoServer+this.MANIFEST_PATH_PATTERN.replace("[productID]",a)),this.dataProvider.getManifestData(a).then(function(ee){var te=this.dataMapper.map(ee),ie=this.getBestAssets(a,te,c);ie.sort((function(a,d){return c.formats.indexOf(a.format)-c.formats.indexOf(d.format)}));var ne={assets:ie,hasAudio:this.hasAudio(ee)};return"function"==typeof d&&d(ne),ne}.bind(this)).fail((function(){"function"==typeof ee&&ee()}))},AssetsProvider})),define("videoPlayerAssetsProvider",[],(function(){return{getAssets:a=>Promise.resolve({assets:[{src:a,type:"video/mp4"}],hasAudio:!0})}})),define("videoPlayer/AssetsProvider",["UnpatchedVideoPlayerAssetsProvider","videoPlayerAssetsProvider"],(function(a,c){var d=a.prototype.getAssets;return a.prototype.getAssets=function(a){return a.slice(0,this.scene7config.scene7videoServer.length)===this.scene7config.scene7videoServer?d.apply(this,arguments):c.getAssets.apply(this,arguments)},a})),define("videoPlayer/viewModel",["ko"],(function(a){return function ViewModel(c,d){this.events=c,this.sources=a.observableArray(),this.messages=d,this.isErrorPageVisible=a.observable(!1),this.isUnsupportedPageVisible=a.observable(!1),this.refreshButtonClicked=function(){this.events.trigger("refreshButtonClicked")}.bind(this),this.closeButtonClicked=function(){this.events.trigger("closeButtonClicked")}.bind(this)}})),define("utils/fullScreenHelper",["$"],(function(a){"use strict";var FullScreenHelper=function(a,c){this.events=a,this.fullscreenLauncherName=this.getFullscreenLauncherName(c),this.fullscreenElementName=this.getFullscreenElementName(c),this.fullscreenCancelName=this.getFullscreenCancelName(c),this.elementStyle={position:null,top:null,left:null,width:null,height:null,backgroundColor:null,zIndex:null},this.setEventListeners(c)};return FullScreenHelper.prototype.getFullscreenLauncherName=function(a){return a.body.requestFullscreen?"requestFullscreen":a.body.mozRequestFullScreen?"mozRequestFullScreen":a.body.webkitRequestFullscreen?"webkitRequestFullscreen":a.body.msRequestFullscreen?"msRequestFullscreen":null},FullScreenHelper.prototype.getFullscreenCancelName=function(a){return a.exitFullscreen?"exitFullscreen":a.mozCancelFullScreen?"mozCancelFullScreen":a.webkitExitFullscreen?"webkitExitFullscreen":null},FullScreenHelper.prototype.getFullscreenElementName=function(a){return"fullscreenElement"in a?"fullscreenElement":"webkitFullscreenElement"in a?"webkitFullscreenElement":"msFullscreenElement"in a?"msFullscreenElement":"mozFullScreenElement"in a?"mozFullScreenElement":null},FullScreenHelper.prototype.getNativeFullScreenElement=function(a){if(this.fullscreenElementName)return a[this.fullscreenElementName]},FullScreenHelper.prototype.getFullScreenElement=function(a){return this.fullscreenElement?this.fullscreenElement:this.getNativeFullScreenElement(a)},FullScreenHelper.prototype.launchIntoFullscreen=function(a,c){this.getFullScreenElement(a)||(this.fullscreenLauncherName?c[this.fullscreenLauncherName]():(this.fullscreenElement=c,this.onFullScreenChange(a)))},FullScreenHelper.prototype.exitFullScreen=function(a,c){if(!c||!this.getNativeFullScreenElement(a)||this.getNativeFullScreenElement(a)===c)if(this.fullscreenCancelName)this.getNativeFullScreenElement(a)&&a[this.fullscreenCancelName]();else if(this.fullscreenElement)try{var d=this.fullscreenElement.parentNode,ee=this.fullscreenElement.nextSibling;d.removeChild(this.fullscreenElement),d.insertBefore(this.fullscreenElement,ee)}catch(a){}finally{this.onFullScreenChange(a)}},FullScreenHelper.prototype.onFullScreenChange=function(a){this.getFullScreenElement(a)?this.events.trigger("fullScreenEntered"):this.events.trigger("fullScreenExited")},FullScreenHelper.prototype.setEventListeners=function(c){a(c).on("webkitfullscreenchange mozfullscreenchange fullscreenchange",this.onFullScreenChange.bind(this,c))},new FullScreenHelper(a({}),document)})),define("videoPlayer/Controller",["$","utils/fullScreenHelper"],(function(a,c){"use strict";var Controller=function(c,d,ee,te,ie){this.loadedAssets=null,this.unmuteVideosWithAudio=!1,this.loadedSources=void 0,this.progressEvents={0:!1,25:!1,50:!1,75:!1,100:!1},this.assetsProvider=c,this.events=te,this.viewModel=ee,this.videoElement=ie,this.params={},this.isError=!1,a.extend(!0,this.params,d),this.setEventListeners()};return Controller.prototype.setEventListeners=function(){var d=a(this.videoElement);d.on("timeupdate",function(){this.onVideoTimeUpdated(),this.videoElement.ended&&this.onVideoPlaybackEnded()}.bind(this)),d.on("webkitendfullscreen",function(){this.onFullScreenExited()}.bind(this)),d.on("error",function(a){var c=a.target;if(c===this.videoElement)this.onVideoError();else if("SOURCE"===c.tagName){var d=Array.prototype.indexOf.call(this.videoElement.querySelectorAll("source"),c);this.onVideoSourceError(d)}}.bind(this)),d.on("canplay",function(){this.isError=!1}.bind(this)),this.viewModel.events.on("videoSourceError",function(a){this.onVideoSourceError(a.detail.sourceIndex)}.bind(this)),this.viewModel.events.on("refreshButtonClicked",function(){this.onRefreshButtonClicked()}.bind(this)),this.viewModel.events.on("closeButtonClicked",function(){this.onCloseButtonClicked()}.bind(this)),c.events.on("fullScreenExited",function(){this.onFullScreenExited()}.bind(this)),c.events.on("fullScreenEntered fullScreenExited",function(){this.onFullScreenChanged()}.bind(this))},Controller.prototype.onVideoPlaybackEnded=function(){--this.remainingLoopCount>0?(this.videoElement.currentTime=0,this.resetProgressEvents(),this.videoElement.play(),this.events.trigger("loopEnded")):(this.stop(),this.events.trigger("allLoopsEnded"))},Controller.prototype.onVideoTimeUpdated=function(){var a=100*this.videoElement.currentTime/this.videoElement.duration;for(var d in this.progressEvents){var ee=parseInt(d,10);!this.progressEvents[d]&&a>=ee&&(this.progressEvents[d]=!0,this.events.trigger("progress",{detail:{src:this.videoElement.currentSrc,value:ee,isFullScreen:c.getFullScreenElement(document)===this.videoElement}}))}},Controller.prototype.onVideoError=function(){this.isError=!0,this.viewModel.isErrorPageVisible(!0),this.events.trigger("playbackError")},Controller.prototype.onVideoSourceError=function(a){a===this.viewModel.sources().length-1&&this.onVideoError()},Controller.prototype.onRefreshButtonClicked=function(){this.videoElement.load(),this.start()},Controller.prototype.onCloseButtonClicked=function(){this.events.trigger("playerExitRequested")},Controller.prototype.onFullScreenExited=function(){this.params.closeOnFullScreenExited&&this.events.trigger("playerExitRequested")},Controller.prototype.onFullScreenChanged=function(){if(!this.params.closeOnFullScreenExited&&4===this.videoElement.readyState){var a=function(){this.videoElement.currentTime<1?(this.videoElement.currentTime+=1,this.videoElement.currentTime-=1):(this.videoElement.currentTime-=1,this.videoElement.currentTime+=1)}.bind(this);this.videoElement.paused?(this.videoElement.play(),a(),this.videoElement.pause()):(a(),this.videoElement.pause(),this.videoElement.play())}},Controller.prototype.hideInfoPages=function(){this.viewModel.isErrorPageVisible(!1)},Controller.prototype.start=function(a){this.hideInfoPages(),this.resetProgressEvents(),this.play(this.params.initialLoopCount||1,this.params.startInFullScreen,a)},Controller.prototype.play=function(a,d,ee){ee&&(this.setAssets(ee.assets),setTimeout(function(){this.videoElement.muted=!this.unmuteVideosWithAudio||!ee.hasAudio}.bind(this),0)),this.videoElement&&this.videoElement.play&&this.loadedAssets&&!this.viewModel.isUnsupportedPageVisible()&&((this.isError||JSON.stringify(this.loadedAssets)!==JSON.stringify(this.viewModel.sources()))&&(this.viewModel.sources(this.loadedAssets),this.videoElement.load()),this.remainingLoopCount=a,this.videoElement.readyState>0&&(this.videoElement.currentTime=0),d&&c.launchIntoFullscreen(document,this.videoElement,!0),this.videoElement.play())},Controller.prototype.stop=function(){this.videoElement&&this.videoElement.pause&&(c.exitFullScreen(document,this.videoElement,!0),this.videoElement.pause(),this.videoElement.readyState>0&&(this.videoElement.currentTime=0))},Controller.prototype.resetProgressEvents=function(){for(var a in this.progressEvents)this.progressEvents[a]=!1},Controller.prototype.hasSupportedAssets=function(a){var c=document.createElement("video");return!(!a||!c.canPlayType)&&a.filter((function(a){return""!==c.canPlayType(a.type)})).length>0},Controller.prototype.setAssets=function(a,c){this.loadedAssets=a,this.viewModel.isUnsupportedPageVisible(!this.hasSupportedAssets(this.loadedAssets))},Controller.prototype.loadAssets=function(a,c,d,ee){this.loadedAssets=null,this.assetsProvider.getAssets(a,c,function(a){var c=a.assets;c&&c.length>0?(this.setAssets(c),"function"==typeof d&&d()):"function"==typeof ee&&ee()}.bind(this),(function(){"function"==typeof ee&&ee()}))},Controller})),define("videoPlayer/component",["ko","$","text!videoPlayerView","utils/scene7.config","utils/scene7.DataProvider","videoPlayer/DataMapper","videoPlayer/AssetsProvider","videoPlayer/viewModel","videoPlayer/Controller"],(function(a,c,d,ee,te,ie,ne,se,re){"use strict";return{viewModel:{createViewModel:function(a,d){var oe=c({}),ae=c({}),ce=d.element.querySelector(".asos-media-players .amp-video-player .amp-video-element");a.messages&&a.messages.unsupportedHeaderText&&(a.messages.unsupportedHeaderText=a.messages.unsupportedHeaderText.replace("[BrowserName]","Your browser"));var le=new se(oe,a.messages),de=new ee(a.scene7.imageServer,a.scene7.videoServer),ue=new te(de),he=new ie(de),pe=new ne(de,ue,he),me=new re(pe,a.player,le,ae,ce),fe={start:me.start.bind(me),stop:me.stop.bind(me),loadAssets:me.loadAssets.bind(me),events:me.events};return a.api(fe),le}},template:d,synchronous:!0}})),define("text!spinViewerView",[],(function(){return'<div class="asos-media-players amp-relative">\n    <div class="amp-spin-viewer amp-relative" data-bind=\'css: { "pannable": isPannable() }\'>\n        <div class="amp-spinner amp-relative">\n            <div class="amp-page amp-spin">\n                <div class="amp-page amp-hint" data-bind="fadeVisible: isHintVisible">\n                    <div class="amp-hint-container">\n                        <div class="amp-hint-gesture amp-first">\n                            <div class="amp-hint-gesture-img sprite drag"></div>\n                        </div>\n                        <div class="amp-clear"></div>\n                        <div class="amp-hint-gesture amp-first">\n                            <span data-bind="text: messages.hintDragText"></span>\n                        </div>\n                        <div class="amp-clear"></div>\n                    </div>\n                </div>\n                <div class="amp-page amp-overlay"></div>\n                \x3c!-- ko if: !touchDevice --\x3e\n                <span class="sr-only" aria-live="polite" data-bind="text: zoomLevelText"></span>\n                <button class="amp-zoom" data-bind="attr: { \'aria-describedby\': hintId }, click: handleClick, event: { keydown: handleKeyDown, keyup: handleKeyUp, blur: handleOnBlur, focus: handleOnFocus }, clickBubble: false">\n                    <span class="sprite" data-bind="css: { zoomPlus: zoomPlus, zoomMinus: zoomMinus }"></span>\n                </button>\n                <p class="zoom-hint" data-bind="text: messages.zoomHint, css: { showHint: showHint }, attr: { id: hintId }" aria-hidden="true"></p>\n                \x3c!-- /ko --\x3e\n                <div class="amp-page amp-images"></div>\n            </div>\n            <div class="amp-page amp-loading" data-bind="visible: isLoadingPageVisible">\n                <div class="amp-loading-img"></div>\n                <span data-bind="text: loadingPercentage() + \'%\'"></span>\n            </div>\n            <div class="amp-page amp-page-message amp-error-page" data-bind="visible: isErrorPageVisible">\n                <div class="amp-message-container">\n                    <div class="amp-message-box">\n                        <h2 data-bind="html: messages.errorHeaderText"></h2>\n                        <p data-bind="html: messages.spinsetErrorMessageText"></p>\n                        <div class="amp-button amp-button-black" data-bind="html: messages.refreshButtonText, click: refreshButtonClicked"></div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>                '})),define("utils/sizeHelper",[],(function(){"use strict";function SizeHelper(){}return SizeHelper.prototype.getProportionalSize=function(a,c){var d={width:a.width,height:a.height},ee=c.width/c.height,te=a.width/a.height;return te>ee?d.width=d.height*ee:te<ee&&(d.height=d.width/ee),d.width=Math.round(d.width),d.height=Math.round(d.height),d},SizeHelper.prototype.resizeCanvas=function(a,c){var d=document.createElement("canvas");d.width=c.width,d.height=c.height,d.getContext("2d").drawImage(a,0,0,c.width,c.height),a.width=c.width,a.height=c.height,a.getContext("2d").drawImage(d,0,0)},new SizeHelper})),define("utils/imageProvider",["$"],(function(a){"use strict";var ImageProvider=function(){};return ImageProvider.prototype.setImage=function(c,d,ee,te,ie,ne){if(ie&&a.support.cors)return d.onload=ee,a.ajax(c,{success:function(a){d.src=c},error:te,cache:!ne});if(ne)c+="&"+(new Date).getTime();else if(d.complete&&d.src===c)return"function"==typeof ee&&ee(),null;return d.onload=ee,d.onerror=te,d.src=c,null},new ImageProvider})),define("utils/scene7.ImageLoader",["$","utils/sizeHelper","utils/imageProvider"],(function(a,c,d){"use strict";var ImageLoader=function(a,c){this.urlQueryStringPattern="wid=[width]&hei=[height]&size=[width],[height]&rect=[startH],[startW],[lengthH],[lengthW]&qlt=[qlt]",this.scene7Config=a,this.canUseCanvas=document.createElement("canvas").getContext,this.useCors=c,this.loadRequests=[]};return ImageLoader.prototype.getPartitionFactors=function(a,c){return{horizontal:Math.max(Math.ceil(a.width/this.scene7Config.maxImageSize.width),c?this.scene7Config.imageMinPartitionFactors.horizontal:1),vertical:Math.max(Math.ceil(a.height/this.scene7Config.maxImageSize.height),c?this.scene7Config.imageMinPartitionFactors.vertical:1)}},ImageLoader.prototype.getTile=function(a,c,ee,te,ie,ne,se,re,oe){var ae=new Image,ce=this.getTileUrl(c,ee,te,ie,ne,se);return{xhr:d.setImage(ce,ae,function(){ae.onload=null,this.loadRequests[a].isActive&&"function"==typeof re&&re(ae)}.bind(this),function(){ae.onload=null,this.loadRequests[a].isActive&&"function"==typeof oe&&oe()}.bind(this),this.useCors),image:ae}},ImageLoader.prototype.addTile=function(a,c,d,ee,te,ie,ne,se,re,oe,ae){this.loadRequests[a].isActive&&this.loadRequests[a].tiles.push(this.getTile(a,d,ee,ie,ne,se,re,function(d){if(this.loadRequests[a].isActive){this.getTileBox(te,ie,ne,se);var ee=c.querySelector('.tile[data-tile-hp="'+ie+'" ][data-tile-vp="'+ne+'"]'),re=ee.querySelector("img");re||((re=new Image).style.width="100%",re.style.height="100%",ee.appendChild(re)),re.src=d.src,"function"==typeof oe&&oe()}}.bind(this),ae))},ImageLoader.prototype.addTiles=function(a,c,d,ee,te,ie,ne,se,re,oe){var ae=a.length,onAddTileComplete=function(){0===--ae&&"function"==typeof re&&re()};0===ae&&"function"==typeof re&&re();for(var ce=0;ce<a.length;ce++)this.addTile(c,d,ee,te,ie,a[ce].horizontal,a[ce].vertical,ne,se,onAddTileComplete,oe)},ImageLoader.prototype.loadFullImage=function(a,ee,te,ie,ne,se,re,oe,ae){(ie.width>this.scene7Config.maxImageSize.width||ie.height>this.scene7Config.maxImageSize.height)&&(ie=c.getProportionalSize(this.scene7Config.maxImageSize,ie));var ce=te.querySelector(".fullImageContainer"),le=te.querySelector(".partitionedImageContainer"),de=te.querySelector(".fullImageContainer img"),ue=!1;ce||((ce=document.createElement("div")).className="fullImageContainer",te.insertBefore(ce,te.firstChild)),de?ue=!de.complete:((de=new Image).className="img",de.style.width="100%",de.style.height="100%",ce.appendChild(de)),ce.style.width=Math.floor(ne.width)+"px",ce.style.height=Math.floor(ne.height)+"px",re&&(ce.style.position=re.position,ce.style.top=re.top,ce.style.left=re.left),ce.setAttribute("data-url",ee),ce.setAttribute("data-target-qlt",se),ce.setAttribute("data-target-width",Math.floor(ie.width)),ce.setAttribute("data-target-height",Math.floor(ie.height)),ce.setAttribute("data-output-width",Math.floor(ne.width)),ce.setAttribute("data-output-height",Math.floor(ne.height));var he=this.getTileUrl(ee,ie,0,0,{vertical:1,horizontal:1},se),pe=d.setImage(he,de,function(){if(de.onload=null,this.loadRequests[a].isActive){if(le)for(;le.lastChild;)le.removeChild(le.lastChild);"function"==typeof oe&&oe()}}.bind(this),function(){de.onload=null,this.loadRequests[a].isActive&&"function"==typeof ae&&ae()}.bind(this),this.useCors,ue);this.loadRequests[a].tiles.push({image:de,xhr:pe})},ImageLoader.prototype.loadImageToContainer=function(a,c,d,ee,te,ie,ne,se,re,oe,ae){ne=ne||{x:d.width/2,y:d.height/2},oe=oe||"";var ce,le,de=this.getPartitionFactors(d,re),ue=(de.horizontal,de.vertical,{topLeft:{x:0,y:0},bottomRight:{x:ee.width-1,y:ee.height-1}}),he=this.getTileDataForPoint(ne,ee,de),pe=this.loadRequests.push({isActive:!0,tiles:[]})-1,me=function(){this.addTiles([he],pe,fe,a,d,ee,de,oe,function(){if(!this.loadRequests[pe].isActive)return!1;this.addTiles(ce,pe,fe,a,d,ee,de,oe,function(){if(!this.loadRequests[pe].isActive)return!1;this.addTiles(le,pe,fe,a,d,ee,de,oe,function(){this.loadRequests[pe].isActive=!1,"function"==typeof te&&te()}.bind(this),function(){if(!this.loadRequests[pe].isActive)return!1;"function"==typeof ie&&ie()}.bind(this))}.bind(this),function(){if(!this.loadRequests[pe].isActive)return!1;"function"==typeof ie&&ie()}.bind(this))}.bind(this),function(){if(!this.loadRequests[pe].isActive)return!1;"function"==typeof ie&&ie()}.bind(this))}.bind(this);if((se=se||ue).topLeft.x=Math.max(Math.min(se.topLeft.x,ue.bottomRight.x),ue.topLeft.x),se.topLeft.y=Math.max(Math.min(se.topLeft.y,ue.bottomRight.y),ue.topLeft.y),se.bottomRight.x=Math.max(Math.min(se.bottomRight.x,ue.bottomRight.x),se.topLeft.x),se.bottomRight.y=Math.max(Math.min(se.bottomRight.y,ue.bottomRight.y),se.topLeft.y),ce=this.getTilesDataForArea(se,ee,[he],he,de),le=this.getTilesDataForArea(ue,ee,[he].concat(ce),he,de),!this.canUseCanvas||1===de.vertical&&1===de.horizontal)this.loadFullImage(pe,a,c,d,ee,oe,ae,te,ie);else{var fe=c.querySelector(".partitionedImageContainer");if(!fe){(fe=document.createElement("div")).className="partitionedImageContainer",fe.style.width=ee.width+"px",fe.style.height=ee.height+"px",fe.setAttribute("aria-hidden","true"),ae&&(fe.style.position=ae.position,fe.style.top=ae.top,fe.style.left=ae.left);for(var ge=0;ge<de.vertical;ge++)for(var ve=0;ve<de.horizontal;ve++){var be=document.createElement("div");be.className="tile",be.style.float="left",be.style.width=100/de.horizontal+"%",be.style.height=100/de.vertical+"%",be.setAttribute("data-tile-hp",ve),be.setAttribute("data-tile-vp",ge),fe.appendChild(be)}c.appendChild(fe)}me()}return pe},ImageLoader.prototype.getTilesDataForArea=function(a,c,d,ee,te){d=d||[],ee=ee||{horizontal:0,vertical:0};for(var ie=this.getTileDataForPoint(a.topLeft,c,te),ne=this.getTileDataForPoint(a.bottomRight,c,te),se=[],fnTileFilter=function(a){return a.horizontal===re&&a.vertical===oe},re=ie.horizontal;re<=ne.horizontal;re++)for(var oe=ie.vertical;oe<=ne.vertical;oe++)0===d.filter(fnTileFilter).length&&se.push({horizontal:re,vertical:oe});return se.sort((function(a,c){return Math.sqrt(Math.pow(a.horizontal-ee.horizontal,2)+Math.pow(a.vertical-ee.vertical))>Math.sqrt(Math.pow(c.horizontal-ee.horizontal,2)+Math.pow(c.vertical-ee.vertical))?1:-1})),se},ImageLoader.prototype.getTileDataForPoint=function(a,c,d){for(var ee,te={horizontal:null,vertical:null},ie=0;ie<d.horizontal&&null===te.horizontal;ie++)ee=this.getTileBox(c,ie,0,d),a.x>=ee.left&&a.x<ee.left+ee.width&&(te.horizontal=ie);for(var ne=0;ne<d.vertical&&null===te.vertical;ne++)ee=this.getTileBox(c,0,ne,d),a.y>=ee.top&&a.y<ee.top+ee.height&&(te.vertical=ne);return te},ImageLoader.prototype.getTileBox=function(a,c,d,ee){var te=this.getPartPosition(c,a.width,ee.horizontal),ie=this.getPartPosition(d,a.height,ee.vertical);return{left:te,top:ie,width:this.getPartPosition(c+1,a.width,ee.horizontal)-te,height:this.getPartPosition(d+1,a.height,ee.vertical)-ie}},ImageLoader.prototype.getPartPosition=function(a,c,d){return Math.floor(c*a/d)},ImageLoader.prototype.getTileUrl=function(a,c,d,ee,te,ie){var ne=this.getTileBox(c,d,ee,te),se=a.indexOf("?")>-1?"&":"?";return(a+se+this.urlQueryStringPattern).replace(/\[width\]/g,Math.floor(c.width)).replace(/\[height\]/g,Math.floor(c.height)).replace("[startH]",Math.floor(ne.left)).replace("[startW]",Math.floor(ne.top)).replace("[lengthH]",Math.floor(ne.width)).replace("[lengthW]",Math.floor(ne.height)).replace("[qlt]",ie)},ImageLoader.prototype.cancelAllLoadRequests=function(){for(var a=0;a<this.loadRequests.length;a++)this.cancelLoadRequest(a)},ImageLoader.prototype.cancelLoadRequest=function(a){if("number"==typeof a&&a<this.loadRequests.length&&this.loadRequests[a].isActive){var c=this.loadRequests[a];if(c.isActive=!1,c.tiles.length)for(var d=c.tiles[0].image.src,ee=c.tiles.pop();ee;)ee.xhr?ee.xhr.abort():(ee.image.onload=null,ee.image.src=d),ee=c.tiles.pop()}},ImageLoader})),define("spinViewer/DataProvider",[],(function(){"use strict";var DataProvider=function(a,c){this.scene7config=a,this.scene7dataProvider=c};return DataProvider.prototype.mapManifestData=function(a){var c={frameUrls:[],maxSize:{width:0,height:0}};if(a.set.item.length>0){var d=a.set.item[0].set?a.set.item.length:1;if(1===d)c.frameUrls[0]=a.set.item.map(function(a){return this.scene7config.imageUrlPattern.replace("[assetID]",a.i.n)}.bind(this)),c.maxSize.width=parseInt(a.set.item[0].dx,10),c.maxSize.height=parseInt(a.set.item[0].dy,10);else{a.set.item[0].set.item.length>0&&(c.maxSize.width=parseInt(a.set.item[0].set.item[0].dx,10),c.maxSize.height=parseInt(a.set.item[0].set.item[0].dy,10));for(var ee=0;ee<d;ee++)c.frameUrls[ee]=a.set.item[ee].set.item.map(function(a){return this.scene7config.imageUrlPattern.replace("[assetID]",a.i.n)}.bind(this))}}return c},DataProvider.prototype.getSpinsetDataForImageUrls=function(a,c,d){for(var ee,te="[baseUrl]?imageset={[imageSet]}&req=set,json",ie=[],ne=0;ne<a.length;ne++)ee=a[ne].split("?").shift(),te=te.replace("[baseUrl]",ee),ie.push(ee.split("/").pop());return te=te.replace("[imageSet]",ie.join(",")),this.scene7dataProvider.getManifestData(te).then(function(a){var d=[];for(Array.isArray(a.set.item)||(a.set.item=[a.set.item]),ne=0;ne<a.set.item.length;ne++)d.push(this.mapManifestData({set:{item:[a.set.item[ne]]}}));return"function"==typeof c&&c(d),d}.bind(this)).fail((function(){"function"==typeof d&&d()}))},DataProvider.prototype.getSpinsetDataForImageUrl=function(a,c,d){var ee=(a=a.split("?").shift())+"?req=set,json";return this.scene7dataProvider.getManifestData(ee).then(function(a){return a.set.item=[a.set.item],"function"==typeof c&&c(a),a}.bind(this)).fail((function(){"function"==typeof d&&d()}))},DataProvider.prototype.getSpinsetDataForProduct=function(a,c,d){var ee=this.scene7config.spinsetManifestFileUrlPattern.replace("[productID]",a);return this.scene7dataProvider.getManifestData(ee).then(function(a){var d=this.mapManifestData(a);return"function"==typeof c&&c(d),d}.bind(this)).fail((function(){"function"==typeof d&&d()}))},DataProvider})),define("spinViewer/config",[],(function(){const a={};let c=!1;return()=>(c||(Object.assign(a,window.asos.pdp.config),c=!0),a)})),define("spinViewer/utils/requests",["spinViewer/config"],(function(a){return()=>{const{appVersion:c}=a();return window.asos.webRequest.configureRequest({client:{name:"asos-web-productpage",version:c}})}})),define("spinViewer/AssetsProvider",["spinViewer/config","spinViewer/utils/requests"],(function(a,c){return class AssetsProvider{getAssets(d,ee){const{imageServer:te,product:{id:ie,products:ne}}=a(),se=(ne||[{id:ie}]).map((a=>a.id)),re=c();Promise.allSettled(se.map((a=>re.get({url:`${te}/image/list/${a}.json`,isThirdParty:!0})))).then((a=>{const c=a.filter((({status:a})=>"fulfilled"===a)).map((a=>a.value.data.resources)).flat(),ie=d.map((a=>{const d=a.split("/").pop(),ee=c.find((a=>a.public_id===d));if(!ee)return{frameUrls:[[]],maxSize:{width:0,height:0}};const{width:ie,height:ne}=ee;return{frameUrls:[[`${te}/products/asos/${d}`]],maxSize:{width:ie,height:ne}}}));ee(ie)}))}}})),define("spinViewer/ViewModel",["ko"],(function(a){return function ViewModel(c,d){var ee,te={};this.touchDevice="ontouchstart"in document.documentElement,this.events=c,this.messages=d,this.isPannable=a.observable(!1),this.isLoadingPageVisible=a.observable(!1),this.loadingPercentage=a.observable(0),this.isErrorPageVisible=a.observable(!1),this.isHintVisible=a.observable(!1),this.zoomPlus=a.observable(!0),this.zoomMinus=a.observable(!1),this.showHint=a.observable(!1),this.zoomLevelText=a.observable(""),this.zoomLevel=a.observable(0),this.updateLiveRegion=function(a){clearTimeout(ee),this.zoomLevelText(a),ee=setTimeout(function(){this.zoomLevelText("")}.bind(this),1e3)}.bind(this),this.hintId=Math.random().toString(36).substring(7),this.refreshButtonClicked=function(){this.events.trigger("refreshButtonClicked")}.bind(this),this.handleOnFocus=function(){this.showHint(!0)}.bind(this),this.handleOnBlur=function(){this.showHint(!1)}.bind(this),this.handleClick=function(){this.events.trigger("zoomCenter")}.bind(this);var ie=["arrowleft","arrowright","arrowup","arrowdown","a","d","w","s"];function getActiveKeys(){return Object.keys(te).filter((function(a){return te[a]}))}function resetPanDirection(a){Object.keys(te).forEach((function(c){a!==c&&-1!==ie.indexOf(c)&&(te[c]=!1)}))}this.handleKeyDown=function(a,c){var d=c.key.toLowerCase();if(te[d]=!0,-1===ie.indexOf(d))return!0;getActiveKeys().filter((function(a){return-1===ie.indexOf(a)})).length>0&&resetPanDirection(d);var ee=function getActivePanKeys(){return getActiveKeys().filter((function(a){return-1!==ie.indexOf(a)}))}().join(",");this.events.trigger("panImage",ee)},this.handleKeyUp=function(a,c){var d=c.key.toLowerCase();return te[d]=!1,-1!==ie.indexOf(d)&&resetPanDirection(),!0},this.touchDevice||(this.events.on("canZoomIn",function(){this.zoomPlus(!0),this.zoomMinus(!1),0===this.zoomLevel()?(this.updateLiveRegion(d.zoomTwoHundred),this.zoomLevel(200)):(this.updateLiveRegion(d.zoomOneHundred),this.zoomLevel(0))}.bind(this)),this.events.on("cantZoomIn",function(){this.zoomPlus(!1),this.zoomMinus(!0),this.updateLiveRegion(d.zoomFourHundred),this.zoomLevel(400)}.bind(this)))}})),define("utils/ImageScaler",["$"],(function(a){"use strict";var ImageScaler=function(c){this.options={},a.extend(!0,this.options,c)};return ImageScaler.prototype.getScaledImageSize=function(a){return{width:this.getScaledImageLength(this.options.baseSize.width,this.options.maxSize.width,a),height:this.getScaledImageLength(this.options.baseSize.height,this.options.maxSize.height,a)}},ImageScaler.prototype.getScaledImageLength=function(a,c,d){return d?Math.pow(Math.pow(a,1/d)*c/a,d):a},ImageScaler})),define("utils/ImageZoomer",["ko","$","utils/sizeHelper"],(function(a,c,d){"use strict";var ImageZoomer=function(d,ee,te,ie){this.events=c({}),this.imageLoader=d,this.inputImageScaler=ee,this.outputImageScaler=te,this.currentLevel=a.observable(0),this.options={},c.extend(!0,this.options,ie),this.options.zoomFactors=[0].concat(this.options.zoomFactors),this.updateCanZoomDummy=a.observable(!1),this.currLoadRequestId=null,this.currentPosition={x:0,y:0},this.currentSize={width:0,height:0},this.canZoomIn=a.computed(this.canZoomIn,this),this.canZoomOut=a.computed(this.canZoomOut,this),this.fullImageStatus=this.FULL_IMAGE_STATUS.NotLoaded};return ImageZoomer.prototype.FULL_IMAGE_STATUS={NotLoaded:0,Loaded:2},ImageZoomer.prototype.init=function(){var a=c(this.options.container);this.containerSize={width:this.options.containerSize?this.options.containerSize.width:a.width(),height:this.options.containerSize?this.options.containerSize.height:a.height()},this.currentSize=this.getOutputImageSize(this.currentLevel()),this.currentPosition=this.getSanitizedPosition(this.currentPosition,this.currentSize),this.applyPosition(!0),this.updateCanZoomDummy(!this.updateCanZoomDummy())},ImageZoomer.prototype.getNextClosestLevel=function(a){for(var c=0,d=0;d<=this.options.zoomFactors.length;){var ee=this.currentSize,te=this.getOutputImageSize(d);if(a&&(ee.width===te.width||ee.height===te.height)){c=d;break}if(ee.width<te.width||ee.height<te.height){c=d;break}d++}return c},ImageZoomer.prototype.resize=function(a,c,d){var ee=this.getNextClosestLevel(!0);this.options.containerSize=c.containerSize,this.options.outputBaseSize=c.outputBaseSize,this.outputImageScaler.options.baseSize=c.imageScalersOptions.outputImageScalerOptions.baseSize,this.outputImageScaler.options.maxSize=c.imageScalersOptions.outputImageScalerOptions.maxSize,this.init(),a&&this.zoom((function(){return ee}),null,d)},ImageZoomer.prototype.canZoomIn=function(){this.updateCanZoomDummy();var a=this.currentSize,c=this.getOutputImageSize(this.options.zoomFactors.length-1);return a.width<c.width||a.height<c.height},ImageZoomer.prototype.canZoomOut=function(){this.updateCanZoomDummy();var a=this.getOutputImageSize(0),c=this.currentSize;return a.width<c.width||a.height<c.height},ImageZoomer.prototype.zoomIn=function(a,c,d){this.canZoomIn()?this.zoom(this.getNextClosestLevel.bind(this,!1),c,d):a?this.zoomReset(d):"function"==typeof d&&d()},ImageZoomer.prototype.zoomOut=function(a,c){this.canZoomOut()?this.zoom(function(){return this.currentLevel()-1}.bind(this),a,c):"function"==typeof c&&c()},ImageZoomer.prototype.zoomReset=function(a,c){if(c){var d=this.getOutputImageSize(0),ee=this.getZoomedImageBox(this.currentSize,this.currentPosition,d);return this.currentSize=ee.size,this.currentPosition=ee.position,this.applyPosition(!0),this.currentLevel(0),void("function"==typeof a&&setTimeout(a,0))}this.zoom(function(){return 0}.bind(this),void 0,a)},ImageZoomer.prototype.loadImage=function(a,c,d,ee,te,ie,ne,se,re,oe,ae){a&&(this.imageLoader.cancelLoadRequest(this.currLoadRequestId),this.currLoadRequestId=this.imageLoader.loadImageToContainer(a,c,d,ee,function(){this.currLoadRequestId=null,"function"==typeof te&&setTimeout(te,0)}.bind(this),ie,ne,se,re,oe,ae))},ImageZoomer.prototype.zoom=function(a,c,d,ee){this.imageLoader.cancelLoadRequest(this.currLoadRequestId),this.fullImageStatus!==this.FULL_IMAGE_STATUS.Loaded&&(this.fullImageStatus=this.FULL_IMAGE_STATUS.NotLoaded);var te=a(),ie=(this.getInputImageSize(te),this.getOutputImageSize(te)),ne=this.getZoomedImageBox(this.currentSize,this.currentPosition,ie,c),se=te>0;this.currentSize=ne.size,this.currentPosition=ne.position,this.applyPosition(!0),this.fullImageStatus===this.FULL_IMAGE_STATUS.NotLoaded&&se&&(this.loadImage(this.options.baseUrl,this.options.container,this.getInputImageSize(this.options.zoomFactors.length-1),this.currentSize,function(){this.fullImageStatus=this.FULL_IMAGE_STATUS.Loaded,this.applyPosition(),"function"==typeof d&&d()}.bind(this),function(){this.fullImageStatus=this.FULL_IMAGE_STATUS.NotLoaded,"function"==typeof ee&&ee()}.bind(this),ne.focalPointOnSourceImage,this.getVisibleArea(ne.position),!0,this.options.zoomJpgQlt,{position:"absolute",top:Math.floor(this.currentPosition.y)+"px",left:Math.floor(this.currentPosition.x)+"px"}),this.applyPosition(!0)),this.currentLevel(te),this.updateCanZoomDummy(!this.updateCanZoomDummy()),this.setPartitionedImageVisibility()},ImageZoomer.prototype.getVisibleArea=function(a){return{topLeft:{x:-a.x,y:-a.y},bottomRight:{x:this.containerSize.width-a.x,y:this.containerSize.height-a.y}}},ImageZoomer.prototype.getZoomedImageBox=function(a,c,d,ee){ee||(ee={x:this.containerSize.width/2,y:this.containerSize.height/2}),ee=this.getSanitizedPointOnImage(ee,a);var te=this.getPointOnOutputImageFromContainer(ee,a),ie=d.width-a.width,ne=d.height-a.height,se=d.width/a.width,re={x:te.x*se,y:te.y*se},oe=ie*(te.x/a.width),ae=ne*(te.y/a.height);return{size:d,position:this.getSanitizedPosition({x:c.x-oe,y:c.y-ae},d),focalPointOnSourceImage:re}},ImageZoomer.prototype.moveBy=function(a){this.canZoomOut()&&(a.x||a.y)&&(this.currentPosition=this.getSanitizedPosition({x:this.currentPosition.x+a.x,y:this.currentPosition.y+a.y},this.currentSize),this.applyPosition())},ImageZoomer.prototype.applyPosition=function(a){var d=c(this.options.container),ee=Math.floor(this.currentSize.width),te=Math.floor(this.currentSize.height),ie=d.find(".fullImageContainer, .partitionedImageContainer");ie.css({position:"absolute",top:Math.floor(this.currentPosition.y)+"px",left:Math.floor(this.currentPosition.x)+"px",width:ee+"px",height:te+"px"}),ie.attr({"data-output-width":ee,"data-output-height":te})},ImageZoomer.prototype.getInputImageSize=function(a){var c=this.options.zoomFactors[a],d=this.inputImageScaler.getScaledImageSize(c);return d.width<this.options.outputBaseSize.width||d.height<this.options.outputBaseSize.height?this.options.outputBaseSize:d},ImageZoomer.prototype.getOutputImageSize=function(a){if(0===a)return this.options.outputBaseSize;var c=this.options.zoomFactors[a],d=this.outputImageScaler.getScaledImageSize(c);return d.width<this.options.outputBaseSize.width||d.height<this.options.outputBaseSize.height?this.options.outputBaseSize:d},ImageZoomer.prototype.setPlaceholderImage=function(a){this.getInputImageSize(0);var d=this.getOutputImageSize(0),ee=this.getZoomedImageBox(this.currentSize,this.currentPosition,d);this.currentSize=ee.size,this.currentPosition=ee.position;var te=c(this.options.container).children(),ie=document.createElement("div");ie.className="fullImageContainer",a.className="img",a.style.width="100%",a.style.height="100%",ie.appendChild(a),this.options.container.appendChild(ie),this.applyPosition(!0),te.remove()},ImageZoomer.prototype.getBezel=function(a){return{horizontal:Math.max(this.containerSize.width-Math.floor(a.width),0)/2,vertical:Math.max(this.containerSize.height-Math.floor(a.height),0)/2}},ImageZoomer.prototype.getSanitizedPosition=function(a,c){var d=this.getBezel(c),ee={x:Math.floor(a.x),y:Math.floor(a.y)};return ee.x=Math.min(ee.x,d.horizontal),ee.y=Math.min(ee.y,d.vertical),ee.x=Math.max(ee.x,this.containerSize.width-Math.floor(c.width)-d.horizontal),ee.y=Math.max(ee.y,this.containerSize.height-Math.floor(c.height)-d.vertical),ee},ImageZoomer.prototype.getSanitizedPointOnImage=function(a,c){var d=this.getBezel(c),ee={x:a.x,y:a.y};return ee.x=Math.max(ee.x,d.horizontal),ee.y=Math.max(ee.y,d.vertical),ee.x=Math.min(ee.x,this.containerSize.width-d.horizontal),ee.y=Math.min(ee.y,this.containerSize.height-d.vertical),ee},ImageZoomer.prototype.getPointOnOutputImageFromContainer=function(a){return{x:a.x-this.currentPosition.x,y:a.y-this.currentPosition.y}},ImageZoomer.prototype.getCurrentImageDisplaySize=function(){return this.currentSize},ImageZoomer.prototype.scale=function(a,c,d,ee){d||(d={x:0,y:0});var te={width:Math.max(a.width*c,this.options.outputBaseSize.width),height:Math.max(a.height*c,this.options.outputBaseSize.height)};if(!ee){var ie=this.getOutputImageSize(this.options.zoomFactors.length-1);te.width=Math.min(ie.width,te.width),te.height=Math.min(ie.height,te.height)}var ne=this.getZoomedImageBox(this.currentSize,this.currentPosition,te,d);this.currentPosition=ne.position,this.currentSize=ne.size,this.applyPosition(!0),this.updateCanZoomDummy(!this.updateCanZoomDummy()),this.setPartitionedImageVisibility()},ImageZoomer.prototype.setPartitionedImageVisibility=function(){this.options.container.querySelector(".partitionedImageContainer")&&(this.currentSize.width!==this.options.outputBaseSize.width?this.options.container.querySelector(".partitionedImageContainer").style.display="block":this.options.container.querySelector(".partitionedImageContainer").style.display="none")},ImageZoomer})),function(a,c,d,ee){"use strict";function e(a,c,d){return setTimeout(j(a,d),c)}function f(a,c,d){return!!Array.isArray(a)&&(g(a,d[c],d),!0)}function g(a,c,d){var te;if(a)if(a.forEach)a.forEach(c,d);else if(a.length!==ee)for(te=0;te<a.length;)c.call(d,a[te],te,a),te++;else for(te in a)a.hasOwnProperty(te)&&c.call(d,a[te],te,a)}function h(c,d,ee){var te="DEPRECATED METHOD: "+d+"\n"+ee+" AT \n";return function(){var d=new Error("get-stack-trace"),ee=d&&d.stack?d.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",ie=a.console&&(a.console.warn||a.console.log);return ie&&ie.call(a.console,te,ee),c.apply(this,arguments)}}function i(a,c,d){var ee,ie=c.prototype;(ee=a.prototype=Object.create(ie)).constructor=a,ee._super=ie,d&&te(ee,d)}function j(a,c){return function(){return a.apply(c,arguments)}}function k(a,c){return typeof a==se?a.apply(c&&c[0]||ee,c):a}function l(a,c){return a===ee?c:a}function m(a,c,d){g(q(c),(function(c){a.addEventListener(c,d,!1)}))}function n(a,c,d){g(q(c),(function(c){a.removeEventListener(c,d,!1)}))}function o(a,c){for(;a;){if(a==c)return!0;a=a.parentNode}return!1}function p(a,c){return a.indexOf(c)>-1}function q(a){return a.trim().split(/\s+/g)}function r(a,c,d){if(a.indexOf&&!d)return a.indexOf(c);for(var ee=0;ee<a.length;){if(d&&a[ee][d]==c||!d&&a[ee]===c)return ee;ee++}return-1}function s(a){return Array.prototype.slice.call(a,0)}function t(a,c,d){for(var ee=[],te=[],ie=0;ie<a.length;){var ne=c?a[ie][c]:a[ie];r(te,ne)<0&&ee.push(a[ie]),te[ie]=ne,ie++}return d&&(ee=c?ee.sort((function(a,d){return a[c]>d[c]})):ee.sort()),ee}function u(a,c){for(var d,te,ne=c[0].toUpperCase()+c.slice(1),se=0;se<ie.length;){if((te=(d=ie[se])?d+ne:c)in a)return te;se++}return ee}function w(c){var d=c.ownerDocument||c;return d.defaultView||d.parentWindow||a}function x(a,c){var d=this;this.manager=a,this.callback=c,this.element=a.element,this.target=a.options.inputTarget,this.domHandler=function(c){k(a.options.enable,[a])&&d.handler(c)},this.init()}function z(a,c,d){var ee=d.pointers.length,te=d.changedPointers.length,ie=c&ve&&ee-te==0,ne=c&(ye|Se)&&ee-te==0;d.isFirst=!!ie,d.isFinal=!!ne,ie&&(a.session={}),d.eventType=c,function A(a,c){var d=a.session,ee=c.pointers,te=ee.length;d.firstInput||(d.firstInput=D(c)),te>1&&!d.firstMultiple?d.firstMultiple=D(c):1===te&&(d.firstMultiple=!1);var ie=d.firstInput,ne=d.firstMultiple,se=ne?ne.center:ie.center,re=c.center=E(ee);c.timeStamp=ae(),c.deltaTime=c.timeStamp-ie.timeStamp,c.angle=I(se,re),c.distance=H(se,re),function B(a,c){var d=c.center,ee=a.offsetDelta||{},te=a.prevDelta||{},ie=a.prevInput||{};c.eventType!==ve&&ie.eventType!==ye||(te=a.prevDelta={x:ie.deltaX||0,y:ie.deltaY||0},ee=a.offsetDelta={x:d.x,y:d.y}),c.deltaX=te.x+(d.x-ee.x),c.deltaY=te.y+(d.y-ee.y)}(d,c),c.offsetDirection=G(c.deltaX,c.deltaY);var ce=F(c.deltaTime,c.deltaX,c.deltaY);c.overallVelocityX=ce.x,c.overallVelocityY=ce.y,c.overallVelocity=oe(ce.x)>oe(ce.y)?ce.x:ce.y,c.scale=ne?function K(a,c){return H(c[0],c[1],Ve)/H(a[0],a[1],Ve)}(ne.pointers,ee):1,c.rotation=ne?function J(a,c){return I(c[1],c[0],Ve)+I(a[1],a[0],Ve)}(ne.pointers,ee):0,c.maxPointers=d.prevInput?c.pointers.length>d.prevInput.maxPointers?c.pointers.length:d.prevInput.maxPointers:c.pointers.length,C(d,c);var le=a.element;o(c.srcEvent.target,le)&&(le=c.srcEvent.target),c.target=le}(a,d),a.emit("hammer.input",d),a.recognize(d),a.session.prevInput=d}function C(a,c){var d,te,ie,ne,se=a.lastInterval||c,re=c.timeStamp-se.timeStamp;if(c.eventType!=Se&&(re>ge||se.velocity===ee)){var ae=c.deltaX-se.deltaX,ce=c.deltaY-se.deltaY,le=F(re,ae,ce);te=le.x,ie=le.y,d=oe(le.x)>oe(le.y)?le.x:le.y,ne=G(ae,ce),a.lastInterval=c}else d=se.velocity,te=se.velocityX,ie=se.velocityY,ne=se.direction;c.velocity=d,c.velocityX=te,c.velocityY=ie,c.direction=ne}function D(a){for(var c=[],d=0;d<a.pointers.length;)c[d]={clientX:re(a.pointers[d].clientX),clientY:re(a.pointers[d].clientY)},d++;return{timeStamp:ae(),pointers:c,center:E(c),deltaX:a.deltaX,deltaY:a.deltaY}}function E(a){var c=a.length;if(1===c)return{x:re(a[0].clientX),y:re(a[0].clientY)};for(var d=0,ee=0,te=0;c>te;)d+=a[te].clientX,ee+=a[te].clientY,te++;return{x:re(d/c),y:re(ee/c)}}function F(a,c,d){return{x:c/a||0,y:d/a||0}}function G(a,c){return a===c?we:oe(a)>=oe(c)?0>a?xe:Ie:0>c?Pe:Te}function H(a,c,d){d||(d=Ae);var ee=c[d[0]]-a[d[0]],te=c[d[1]]-a[d[1]];return Math.sqrt(ee*ee+te*te)}function I(a,c,d){d||(d=Ae);var ee=c[d[0]]-a[d[0]],te=c[d[1]]-a[d[1]];return 180*Math.atan2(te,ee)/Math.PI}function L(){this.evEl=ke,this.evWin=Me,this.pressed=!1,x.apply(this,arguments)}function M(){this.evEl=Re,this.evWin=Fe,x.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}function N(){this.evTarget=Ue,this.evWin=Be,this.started=!1,x.apply(this,arguments)}function O(a,c){var d=s(a.touches),ee=s(a.changedTouches);return c&(ye|Se)&&(d=t(d.concat(ee),"identifier",!0)),[d,ee]}function P(){this.evTarget=Ge,this.targetIds={},x.apply(this,arguments)}function Q(a,c){var d=s(a.touches),ee=this.targetIds;if(c&(ve|be)&&1===d.length)return ee[d[0].identifier]=!0,[d,d];var te,ie,ne=s(a.changedTouches),se=[],re=this.target;if(ie=d.filter((function(a){return o(a.target,re)})),c===ve)for(te=0;te<ie.length;)ee[ie[te].identifier]=!0,te++;for(te=0;te<ne.length;)ee[ne[te].identifier]&&se.push(ne[te]),c&(ye|Se)&&delete ee[ne[te].identifier],te++;return se.length?[t(ie.concat(se),"identifier",!0),se]:void 0}function R(){x.apply(this,arguments);var a=j(this.handler,this);this.touch=new P(this.manager,a),this.mouse=new L(this.manager,a),this.primaryTouch=null,this.lastTouches=[]}function S(a,c){a&ve?(this.primaryTouch=c.changedPointers[0].identifier,T.call(this,c)):a&(ye|Se)&&T.call(this,c)}function T(a){var c=a.changedPointers[0];if(c.identifier===this.primaryTouch){var d={x:c.clientX,y:c.clientY};this.lastTouches.push(d);var ee=this.lastTouches;setTimeout((function(){var a=ee.indexOf(d);a>-1&&ee.splice(a,1)}),qe)}}function U(a){for(var c=a.srcEvent.clientX,d=a.srcEvent.clientY,ee=0;ee<this.lastTouches.length;ee++){var te=this.lastTouches[ee],ie=Math.abs(c-te.x),ne=Math.abs(d-te.y);if($e>=ie&&$e>=ne)return!0}return!1}function V(a,c){this.manager=a,this.set(c)}function Y(a){this.options=te({},this.defaults,a||{}),this.id=function v(){return de++}(),this.manager=null,this.options.enable=l(this.options.enable,!0),this.state=et,this.simultaneous={},this.requireFail=[]}function Z(a){return a&rt?"cancel":a&nt?"end":a&it?"move":a&tt?"start":""}function $(a){return a==Te?"down":a==Pe?"up":a==xe?"left":a==Ie?"right":""}function _(a,c){var d=c.manager;return d?d.get(a):a}function aa(){Y.apply(this,arguments)}function ba(){aa.apply(this,arguments),this.pX=null,this.pY=null}function ca(){aa.apply(this,arguments)}function da(){Y.apply(this,arguments),this._timer=null,this._input=null}function ea(){aa.apply(this,arguments)}function fa(){aa.apply(this,arguments)}function ga(){Y.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function ha(a,c){return(c=c||{}).recognizers=l(c.recognizers,ha.defaults.preset),new ia(a,c)}function ia(a,c){this.options=te({},ha.defaults,c||{}),this.options.inputTarget=this.options.inputTarget||a,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=a,this.input=function y(a){var c=a.options.inputClass;return new(c||(he?M:pe?P:ue?R:L))(a,z)}(this),this.touchAction=new V(this,this.options.touchAction),ja(this,!0),g(this.options.recognizers,(function(a){var c=this.add(new a[0](a[1]));a[2]&&c.recognizeWith(a[2]),a[3]&&c.requireFailure(a[3])}),this)}function ja(a,c){var d,ee=a.element;ee.style&&(g(a.options.cssProps,(function(te,ie){d=u(ee.style,ie),c?(a.oldCssProps[d]=ee.style[d],ee.style[d]=te):ee.style[d]=a.oldCssProps[d]||""})),c||(a.oldCssProps={}))}function ka(a,d){var ee=c.createEvent("Event");ee.initEvent(a,!0,!0),ee.gesture=d,d.target.dispatchEvent(ee)}var te,ie=["","webkit","Moz","MS","ms","o"],ne=c.createElement("div"),se="function",re=Math.round,oe=Math.abs,ae=Date.now;te="function"!=typeof Object.assign?function(a){if(a===ee||null===a)throw new TypeError("Cannot convert undefined or null to object");for(var c=Object(a),d=1;d<arguments.length;d++){var te=arguments[d];if(te!==ee&&null!==te)for(var ie in te)te.hasOwnProperty(ie)&&(c[ie]=te[ie])}return c}:Object.assign;var ce=h((function(a,c,d){for(var te=Object.keys(c),ie=0;ie<te.length;)(!d||d&&a[te[ie]]===ee)&&(a[te[ie]]=c[te[ie]]),ie++;return a}),"extend","Use `assign`."),le=h((function(a,c){return ce(a,c,!0)}),"merge","Use `assign`."),de=1,ue="ontouchstart"in a,he=u(a,"PointerEvent")!==ee,pe=ue&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),me="touch",fe="mouse",ge=25,ve=1,be=2,ye=4,Se=8,we=1,xe=2,Ie=4,Pe=8,Te=16,ze=xe|Ie,Ee=Pe|Te,Ce=ze|Ee,Ae=["x","y"],Ve=["clientX","clientY"];x.prototype={handler:function(){},init:function(){this.evEl&&m(this.element,this.evEl,this.domHandler),this.evTarget&&m(this.target,this.evTarget,this.domHandler),this.evWin&&m(w(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&n(this.element,this.evEl,this.domHandler),this.evTarget&&n(this.target,this.evTarget,this.domHandler),this.evWin&&n(w(this.element),this.evWin,this.domHandler)}};var _e={mousedown:ve,mousemove:be,mouseup:ye},ke="mousedown",Me="mousemove mouseup";i(L,x,{handler:function(a){var c=_e[a.type];c&ve&&0===a.button&&(this.pressed=!0),c&be&&1!==a.which&&(c=ye),this.pressed&&(c&ye&&(this.pressed=!1),this.callback(this.manager,c,{pointers:[a],changedPointers:[a],pointerType:fe,srcEvent:a}))}});var De={pointerdown:ve,pointermove:be,pointerup:ye,pointercancel:Se,pointerout:Se},Le={2:me,3:"pen",4:fe,5:"kinect"},Re="pointerdown",Fe="pointermove pointerup pointercancel";a.MSPointerEvent&&!a.PointerEvent&&(Re="MSPointerDown",Fe="MSPointerMove MSPointerUp MSPointerCancel"),i(M,x,{handler:function(a){var c=this.store,d=!1,ee=a.type.toLowerCase().replace("ms",""),te=De[ee],ie=Le[a.pointerType]||a.pointerType,ne=ie==me,se=r(c,a.pointerId,"pointerId");te&ve&&(0===a.button||ne)?0>se&&(c.push(a),se=c.length-1):te&(ye|Se)&&(d=!0),0>se||(c[se]=a,this.callback(this.manager,te,{pointers:c,changedPointers:[a],pointerType:ie,srcEvent:a}),d&&c.splice(se,1))}});var Oe={touchstart:ve,touchmove:be,touchend:ye,touchcancel:Se},Ue="touchstart",Be="touchstart touchmove touchend touchcancel";i(N,x,{handler:function(a){var c=Oe[a.type];if(c===ve&&(this.started=!0),this.started){var d=O.call(this,a,c);c&(ye|Se)&&d[0].length-d[1].length==0&&(this.started=!1),this.callback(this.manager,c,{pointers:d[0],changedPointers:d[1],pointerType:me,srcEvent:a})}}});var Ne={touchstart:ve,touchmove:be,touchend:ye,touchcancel:Se},Ge="touchstart touchmove touchend touchcancel";i(P,x,{handler:function(a){var c=Ne[a.type],d=Q.call(this,a,c);d&&this.callback(this.manager,c,{pointers:d[0],changedPointers:d[1],pointerType:me,srcEvent:a})}});var qe=2500,$e=25;i(R,x,{handler:function(a,c,d){var ee=d.pointerType==me,te=d.pointerType==fe;if(!(te&&d.sourceCapabilities&&d.sourceCapabilities.firesTouchEvents)){if(ee)S.call(this,c,d);else if(te&&U.call(this,d))return;this.callback(a,c,d)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var We=u(ne.style,"touchAction"),He=We!==ee,Ze="compute",je="auto",Ye="manipulation",Xe="none",Je="pan-x",Qe="pan-y",Ke=function X(){if(!He)return!1;var c={},d=a.CSS&&a.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach((function(ee){c[ee]=!d||a.CSS.supports("touch-action",ee)})),c}();V.prototype={set:function(a){a==Ze&&(a=this.compute()),He&&this.manager.element.style&&Ke[a]&&(this.manager.element.style[We]=a),this.actions=a.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var a=[];return g(this.manager.recognizers,(function(c){k(c.options.enable,[c])&&(a=a.concat(c.getTouchAction()))})),function W(a){if(p(a,Xe))return Xe;var c=p(a,Je),d=p(a,Qe);return c&&d?Xe:c||d?c?Je:Qe:p(a,Ye)?Ye:je}(a.join(" "))},preventDefaults:function(a){var c=a.srcEvent,d=a.offsetDirection;if(!this.manager.session.prevented){var ee=this.actions,te=p(ee,Xe)&&!Ke[Xe],ie=p(ee,Qe)&&!Ke[Qe],ne=p(ee,Je)&&!Ke[Je];if(te){var se=1===a.pointers.length,re=a.distance<2,oe=a.deltaTime<250;if(se&&re&&oe)return}return ne&&ie?void 0:te||ie&&d&ze||ne&&d&Ee?this.preventSrc(c):void 0}c.preventDefault()},preventSrc:function(a){this.manager.session.prevented=!0,a.preventDefault()}};var et=1,tt=2,it=4,nt=8,st=nt,rt=16,ot=32;Y.prototype={defaults:{},set:function(a){return te(this.options,a),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(a){if(f(a,"recognizeWith",this))return this;var c=this.simultaneous;return c[(a=_(a,this)).id]||(c[a.id]=a,a.recognizeWith(this)),this},dropRecognizeWith:function(a){return f(a,"dropRecognizeWith",this)||(a=_(a,this),delete this.simultaneous[a.id]),this},requireFailure:function(a){if(f(a,"requireFailure",this))return this;var c=this.requireFail;return-1===r(c,a=_(a,this))&&(c.push(a),a.requireFailure(this)),this},dropRequireFailure:function(a){if(f(a,"dropRequireFailure",this))return this;a=_(a,this);var c=r(this.requireFail,a);return c>-1&&this.requireFail.splice(c,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(a){return!!this.simultaneous[a.id]},emit:function(a){function b(d){c.manager.emit(d,a)}var c=this,d=this.state;nt>d&&b(c.options.event+Z(d)),b(c.options.event),a.additionalEvent&&b(a.additionalEvent),d>=nt&&b(c.options.event+Z(d))},tryEmit:function(a){return this.canEmit()?this.emit(a):void(this.state=ot)},canEmit:function(){for(var a=0;a<this.requireFail.length;){if(!(this.requireFail[a].state&(ot|et)))return!1;a++}return!0},recognize:function(a){var c=te({},a);return k(this.options.enable,[this,c])?(this.state&(st|rt|ot)&&(this.state=et),this.state=this.process(c),void(this.state&(tt|it|nt|rt)&&this.tryEmit(c))):(this.reset(),void(this.state=ot))},process:function(a){},getTouchAction:function(){},reset:function(){}},i(aa,Y,{defaults:{pointers:1},attrTest:function(a){var c=this.options.pointers;return 0===c||a.pointers.length===c},process:function(a){var c=this.state,d=a.eventType,ee=c&(tt|it),te=this.attrTest(a);return ee&&(d&Se||!te)?c|rt:ee||te?d&ye?c|nt:c&tt?c|it:tt:ot}}),i(ba,aa,{defaults:{event:"pan",threshold:10,pointers:1,direction:Ce},getTouchAction:function(){var a=this.options.direction,c=[];return a&ze&&c.push(Qe),a&Ee&&c.push(Je),c},directionTest:function(a){var c=this.options,d=!0,ee=a.distance,te=a.direction,ie=a.deltaX,ne=a.deltaY;return te&c.direction||(c.direction&ze?(te=0===ie?we:0>ie?xe:Ie,d=ie!=this.pX,ee=Math.abs(a.deltaX)):(te=0===ne?we:0>ne?Pe:Te,d=ne!=this.pY,ee=Math.abs(a.deltaY))),a.direction=te,d&&ee>c.threshold&&te&c.direction},attrTest:function(a){return aa.prototype.attrTest.call(this,a)&&(this.state&tt||!(this.state&tt)&&this.directionTest(a))},emit:function(a){this.pX=a.deltaX,this.pY=a.deltaY;var c=$(a.direction);c&&(a.additionalEvent=this.options.event+c),this._super.emit.call(this,a)}}),i(ca,aa,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Xe]},attrTest:function(a){return this._super.attrTest.call(this,a)&&(Math.abs(a.scale-1)>this.options.threshold||this.state&tt)},emit:function(a){if(1!==a.scale){var c=a.scale<1?"in":"out";a.additionalEvent=this.options.event+c}this._super.emit.call(this,a)}}),i(da,Y,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[je]},process:function(a){var c=this.options,d=a.pointers.length===c.pointers,ee=a.distance<c.threshold,te=a.deltaTime>c.time;if(this._input=a,!ee||!d||a.eventType&(ye|Se)&&!te)this.reset();else if(a.eventType&ve)this.reset(),this._timer=e((function(){this.state=st,this.tryEmit()}),c.time,this);else if(a.eventType&ye)return st;return ot},reset:function(){clearTimeout(this._timer)},emit:function(a){this.state===st&&(a&&a.eventType&ye?this.manager.emit(this.options.event+"up",a):(this._input.timeStamp=ae(),this.manager.emit(this.options.event,this._input)))}}),i(ea,aa,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Xe]},attrTest:function(a){return this._super.attrTest.call(this,a)&&(Math.abs(a.rotation)>this.options.threshold||this.state&tt)}}),i(fa,aa,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:ze|Ee,pointers:1},getTouchAction:function(){return ba.prototype.getTouchAction.call(this)},attrTest:function(a){var c,d=this.options.direction;return d&(ze|Ee)?c=a.overallVelocity:d&ze?c=a.overallVelocityX:d&Ee&&(c=a.overallVelocityY),this._super.attrTest.call(this,a)&&d&a.offsetDirection&&a.distance>this.options.threshold&&a.maxPointers==this.options.pointers&&oe(c)>this.options.velocity&&a.eventType&ye},emit:function(a){var c=$(a.offsetDirection);c&&this.manager.emit(this.options.event+c,a),this.manager.emit(this.options.event,a)}}),i(ga,Y,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[Ye]},process:function(a){var c=this.options,d=a.pointers.length===c.pointers,ee=a.distance<c.threshold,te=a.deltaTime<c.time;if(this.reset(),a.eventType&ve&&0===this.count)return this.failTimeout();if(ee&&te&&d){if(a.eventType!=ye)return this.failTimeout();var ie=!this.pTime||a.timeStamp-this.pTime<c.interval,ne=!this.pCenter||H(this.pCenter,a.center)<c.posThreshold;if(this.pTime=a.timeStamp,this.pCenter=a.center,ne&&ie?this.count+=1:this.count=1,this._input=a,0===this.count%c.taps)return this.hasRequireFailures()?(this._timer=e((function(){this.state=st,this.tryEmit()}),c.interval,this),tt):st}return ot},failTimeout:function(){return this._timer=e((function(){this.state=ot}),this.options.interval,this),ot},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==st&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),ha.VERSION="2.0.7",ha.defaults={domEvents:!1,touchAction:Ze,enable:!0,inputTarget:null,inputClass:null,preset:[[ea,{enable:!1}],[ca,{enable:!1},["rotate"]],[fa,{direction:ze}],[ba,{direction:ze},["swipe"]],[ga],[ga,{event:"doubletap",taps:2},["tap"]],[da]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};ia.prototype={set:function(a){return te(this.options,a),a.touchAction&&this.touchAction.update(),a.inputTarget&&(this.input.destroy(),this.input.target=a.inputTarget,this.input.init()),this},stop:function(a){this.session.stopped=a?2:1},recognize:function(a){var c=this.session;if(!c.stopped){this.touchAction.preventDefaults(a);var d,ee=this.recognizers,te=c.curRecognizer;(!te||te&&te.state&st)&&(te=c.curRecognizer=null);for(var ie=0;ie<ee.length;)d=ee[ie],2===c.stopped||te&&d!=te&&!d.canRecognizeWith(te)?d.reset():d.recognize(a),!te&&d.state&(tt|it|nt)&&(te=c.curRecognizer=d),ie++}},get:function(a){if(a instanceof Y)return a;for(var c=this.recognizers,d=0;d<c.length;d++)if(c[d].options.event==a)return c[d];return null},add:function(a){if(f(a,"add",this))return this;var c=this.get(a.options.event);return c&&this.remove(c),this.recognizers.push(a),a.manager=this,this.touchAction.update(),a},remove:function(a){if(f(a,"remove",this))return this;if(a=this.get(a)){var c=this.recognizers,d=r(c,a);-1!==d&&(c.splice(d,1),this.touchAction.update())}return this},on:function(a,c){if(a!==ee&&c!==ee){var d=this.handlers;return g(q(a),(function(a){d[a]=d[a]||[],d[a].push(c)})),this}},off:function(a,c){if(a!==ee){var d=this.handlers;return g(q(a),(function(a){c?d[a]&&d[a].splice(r(d[a],c),1):delete d[a]})),this}},emit:function(a,c){this.options.domEvents&&ka(a,c);var d=this.handlers[a]&&this.handlers[a].slice();if(d&&d.length){c.type=a,c.preventDefault=function(){c.srcEvent.preventDefault()};for(var ee=0;ee<d.length;)d[ee](c),ee++}},destroy:function(){this.element&&ja(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},te(ha,{INPUT_START:ve,INPUT_MOVE:be,INPUT_END:ye,INPUT_CANCEL:Se,STATE_POSSIBLE:et,STATE_BEGAN:tt,STATE_CHANGED:it,STATE_ENDED:nt,STATE_RECOGNIZED:st,STATE_CANCELLED:rt,STATE_FAILED:ot,DIRECTION_NONE:we,DIRECTION_LEFT:xe,DIRECTION_RIGHT:Ie,DIRECTION_UP:Pe,DIRECTION_DOWN:Te,DIRECTION_HORIZONTAL:ze,DIRECTION_VERTICAL:Ee,DIRECTION_ALL:Ce,Manager:ia,Input:x,TouchAction:V,TouchInput:P,MouseInput:L,PointerEventInput:M,TouchMouseInput:R,SingleTouchInput:N,Recognizer:Y,AttrRecognizer:aa,Tap:ga,Pan:ba,Swipe:fa,Pinch:ca,Rotate:ea,Press:da,on:m,off:n,each:g,merge:le,extend:ce,assign:te,inherit:i,bindFn:j,prefixed:u}),(void 0!==a?a:"undefined"!=typeof self?self:{}).Hammer=ha,"function"==typeof define&&define.amd?define("hammer",[],(function(){return ha})):"undefined"!=typeof module&&module.exports?module.exports=ha:a.Hammer=ha}(window,document),define("UnpatchedSpinViewerController",["ko","$","utils/deviceHelper","utils/sizeHelper","utils/ImageScaler","utils/ImageZoomer","hammer"],(function(a,c,d,ee,te,ie,ne){"use strict";var Controller=function(ee,te,ie,ne,se,re){this.assetsProvider=ee,this.imageLoader=te,this.loadedAssets=null,this.events=re,this.containers=se,this.params={showHint:!1,spinSpeed:1,maxPixelRatio:1.5,hintDisplayTime:3e3,preloadingTimeout:0,handleLoadingErrors:!0,framesCachingQueueInterval:35,useInitialAnimation:!1,animationFramesCount:-1,animationIntervalStart:40,animationIntervalPeak:5},this.viewModel=ne,this.updateZoomerDummy=a.observable(!1),this.initState=this.INIT_STATE.NotInitialized,this.frames=[[]],this.lastInitArguments=null,this.currentRowIndex=a.observable(0),this.currentFrameIndex=a.observable(),c.extend(!0,this.params,ie),this.params.devicePixelRatio=Math.min(d.getDevicePixelRatio(this.containers.window),this.params.maxPixelRatio),this.isPannable=a.computed(this.isPannable,this),this.hasError=a.observable(!1),this.getCurrentZoomer=a.computed(this.getCurrentZoomer,this),this.setEventListeners(),this.viewModel.isPannable(this.isPannable())};return Controller.prototype.MIN_GESTURE_RECOGNIZE_DISTANCE=10,Controller.prototype.INIT_STATE={NotInitialized:0,Initializing:1,Initialized:2},Controller.prototype.init=function(a,c){if(this.initState!==this.INIT_STATE.Initializing)return c&&c.initImage&&(c=c.initImage.image),this.lastInitArguments=arguments,this.updateSpinContainerSize(),this.targetSize=this.getContainerInitialTargetSize(),c?(this.setInitialImage(c),this.initState=this.INIT_STATE.Initialized,void this.showFrame(0,0,!0)):this.initState!==this.INIT_STATE.Initialized?(this.initState=this.INIT_STATE.Initializing,void this.preloadImages(0,0)):void this.resize(function(){this.showFrame(0,0,!0)}.bind(this))},Controller.prototype.isVisible=function(){return"none"!==window.getComputedStyle(this.containers.spin).display},Controller.prototype.setInitialImage=function(a){var c=this.getZoomer(0,0);c.options.baseUrl=this.loadedAssets.frameUrls[0][0],c.zoomReset(null,!0),a.className="img",c.setPlaceholderImage(a)},Controller.prototype.updateSpinContainerSize=function(){this.spinContainerRect=this.containers.spin.getBoundingClientRect(),this.spinContainerSize={width:this.spinContainerRect.width,height:this.spinContainerRect.height}},Controller.prototype.isPannable=function(){var a=this.getCurrentZoomer();return a&&a.canZoomOut()},Controller.prototype.zoomIn=function(a,c,d){var ee=this.getCurrentZoomer();if(ee&&(a||ee.canZoomIn()))return this.events.trigger("zoomedIn"),this.imageLoader.cancelAllLoadRequests(),ee.zoomIn(a,c,d),void(ee.canZoomIn()?this.viewModel.events.trigger("canZoomIn"):this.viewModel.events.trigger("cantZoomIn"));"function"==typeof d&&d()},Controller.prototype.zoomReset=function(a){var c=this.getCurrentZoomer();if(c)return this.imageLoader.cancelAllLoadRequests(),void c.zoomReset(a);"function"==typeof a&&a()},Controller.prototype.zoomOut=function(a,c){var d=this.getCurrentZoomer();if(d&&d.canZoomOut())return this.imageLoader.cancelAllLoadRequests(),void d.zoomOut(focalPointInContainer,c);"function"==typeof c&&c()},Controller.prototype.getEventPositionRelativeToTarget=function(a,c){return{x:(a.center?a.center.x:a.clientX)-c.left,y:(a.center?a.center.y:a.clientY)-c.top}},Controller.prototype.resize=function(a){if(this.isVisible()){var c=this.frames.length*this.frames[0].length,onResizeComplete=function(){--c||"function"==typeof a&&a()};if(this.updateSpinContainerSize(),!c)return void("function"==typeof a&&a());for(var d=0;d<this.frames.length;d++)for(var ee=0;ee<this.frames[d].length;ee++){var te=this.getOutputBaseSize();this.frames[d][ee].resize(!0,{containerSize:this.spinContainerSize,outputBaseSize:te,imageScalersOptions:this.getImageScalersOptions(te)},onResizeComplete)}}},Controller.prototype.animationIntervalEasing=function(a,c){var d=this.params.animationIntervalPeak-this.params.animationIntervalStart,ee=(Math.sin(2*Math.PI*a/c-Math.PI/2)+1)/2;return this.params.animationIntervalStart+ee*d},Controller.prototype.refresh=function(){this.init.apply(this,this.lastInitArguments)},Controller.prototype.animateSpin=function(a,c,d,ee){var te=a,ie=0,ne=c>a?c-a:this.frames[this.currentRowIndex()].length+c-a,se=function(){this.showFrame(this.currentRowIndex(),te,!0),te!==c?(te++,ie++,te>=this.frames[this.currentRowIndex()].length&&(te=0),setTimeout(se,d(ie,ne))):"function"==typeof ee&&ee()}.bind(this);se()},Controller.prototype.getZoomer=function(a,c){var d,ee=this.getOutputBaseSize(),te=this.getImageScalersOptions(ee);return this.frames[a]=this.frames[a]||[],(d=this.frames[a][c])||(d=this.createZoomer(),this.frames[a][c]=d,this.updateZoomerDummy(!this.updateZoomerDummy())),d.inputImageScaler.options.baseSize=te.inputImageScalerOptions.baseSize,d.inputImageScaler.options.maxSize=te.inputImageScalerOptions.maxSize,d.resize(!1,{containerSize:this.spinContainerSize,outputBaseSize:ee,imageScalersOptions:te}),d},Controller.prototype.getImageScalersOptions=function(a){var c={width:this.loadedAssets.maxSize.width,height:this.loadedAssets.maxSize.height};return{inputImageScalerOptions:{baseSize:{width:Math.min(this.loadedAssets.maxSize.width,this.targetSize.width*this.params.devicePixelRatio),height:Math.min(this.loadedAssets.maxSize.height,this.targetSize.height*this.params.devicePixelRatio)},maxSize:c},outputImageScalerOptions:{baseSize:a,maxSize:{width:Math.max(a.width,this.loadedAssets.maxSize.width/this.params.devicePixelRatio),height:Math.max(a.height,this.loadedAssets.maxSize.height/this.params.devicePixelRatio)}}}},Controller.prototype.createZoomer=function(a){var c=document.createElement("div"),d=this.getOutputBaseSize(),ee=this.getImageScalersOptions(d),ne=new te(ee.inputImageScalerOptions),se=new te(ee.outputImageScalerOptions);return c.className="amp-frame",new ie(this.imageLoader,ne,se,{baseUrl:a,zoomFactors:this.params.zoomFactors,container:c,containerSize:this.spinContainerSize,outputBaseSize:d,devicePixelRatio:this.params.devicePixelRatio,baseJpgQlt:this.params.baseJpgQlt,zoomJpgQlt:this.params.zoomJpgQlt})},Controller.prototype.getContainerInitialTargetSize=function(){var a=ee.getProportionalSize({width:this.spinContainerSize.width,height:this.spinContainerSize.height},this.loadedAssets.maxSize);return this.params.initialSize&&(a.width=this.params.initialSize.width,a.height=this.loadedAssets.maxSize.height*a.width/this.loadedAssets.maxSize.width),a},Controller.prototype.getOutputBaseSize=function(){return ee.getProportionalSize(this.spinContainerSize,this.loadedAssets.maxSize)},Controller.prototype.preloadImages=function(a,c,d){this.viewModel.loadingPercentage(0),this.hasError(!1);var ee,te=null,ie=!1,ne=[],se=null,fnLoadError=function(){ie=!0,re--,oe--,re||(clearTimeout(te),te=null,clearInterval(se),se=null,this.hasError(!0),this.initState=this.INIT_STATE.NotInitialized)},fnLoadSuccess=function(a,c,d){d.applyPosition(),re--,ee>1&&ne.push({rowIndex:a,frameIndex:c})},fnLoadFrame=function(a,c,d){d.loadImage(this.loadedAssets.frameUrls[a][c],d.options.container,d.inputImageScaler.options.baseSize,d.options.outputBaseSize,fnLoadSuccess.bind(this,a,c,d),this.params.handleLoadingErrors?fnLoadError.bind(this):fnLoadSuccess.bind(this,a,c,d),null,null,1===ee,this.params.baseJpgQlt)},re=ee=this.loadedAssets.frameUrls.length*this.loadedAssets.frameUrls[0].length,oe=ee;ee>1&&this.viewModel.isLoadingPageVisible(!0),se=setInterval(function(a){var c=ne.pop();if(c)return this.showFrame(c.rowIndex,c.frameIndex,!0),oe--,void this.viewModel.loadingPercentage(Math.floor(100*(ee-oe)/ee));re||(clearInterval(se),se=null,"function"==typeof a&&a())}.bind(this,function(){if(clearTimeout(te),te=null,this.hasError(ie),ie)return this.events.trigger("allImagesLoaded",!1),void(this.initState=this.INIT_STATE.NotInitialized);this.events.trigger("allImagesLoaded",!0);var d=this.frames[a].length,ee=c,ne=(d+c-1)%d;if(!this.params.showHint||window.sessionStorage&&window.sessionStorage.getItem("spinViewerHintDisplayed")||(this.viewModel.isHintVisible(!0),setTimeout(function(){this.viewModel.isHintVisible(!1),window.sessionStorage&&window.sessionStorage.setItem("spinViewerHintDisplayed",!0)}.bind(this),this.params.hintDisplayTime)),this.params.useInitialAnimation)return ee=(d+c-this.params.animationFramesCount)%d,ne=c,this.showFrame(a,ee,!0),this.viewModel.isLoadingPageVisible(!1),void this.animateSpin(ee,ne,this.animationIntervalEasing.bind(this),function(){this.initState=this.INIT_STATE.Initialized,this.showFrame(a,c,!0)}.bind(this));this.viewModel.isLoadingPageVisible(!1),this.initState=this.INIT_STATE.Initialized,this.showFrame(a,c,!0)}.bind(this)),this.params.framesCachingQueueInterval),this.imageLoader.cancelAllLoadRequests(),this.params.handleLoadingErrors&&this.params.preloadingTimeout&&(te=setTimeout(function(){clearInterval(se),se=null,this.imageLoader.cancelAllLoadRequests(),this.hasError(!0),this.initState=this.INIT_STATE.NotInitialized}.bind(this),this.params.preloadingTimeout));for(var ae=0;ae<this.loadedAssets.frameUrls.length;ae++)for(var ce=0;ce<this.loadedAssets.frameUrls[ae].length;ce++){var le=this.getZoomer(ae,ce);le.options.baseUrl=this.loadedAssets.frameUrls[ae][ce],fnLoadFrame.call(this,ae,ce,le)}},Controller.prototype.getCurrentZoomer=function(){return this.updateZoomerDummy(),this.currentRowIndex()<this.frames.length&&this.frames[this.currentRowIndex()]&&this.currentFrameIndex()<this.frames[this.currentRowIndex()].length?this.frames[this.currentRowIndex()][this.currentFrameIndex()]:null},Controller.prototype.getCurrentFrame=function(){return{rowIndex:this.currentRowIndex(),frameIndex:this.currentFrameIndex(),zoomer:this.getCurrentZoomer()}},Controller.prototype.showFrame=function(a,c,d){if((d||this.initState===this.INIT_STATE.Initialized)&&(a!=this.currentRowIndex()||c!=this.currentFrameIndex())){this.currentRowIndex(a),this.currentFrameIndex(c);for(var ee=this.getCurrentFrame();this.containers.images.lastChild;)this.containers.images.removeChild(this.containers.images.lastChild);this.containers.images.appendChild(ee.zoomer.options.container),this.events.trigger("frameShown",ee)}},Controller.prototype.loadFullImage=function(a,c){a.fullImageStatus=a.FULL_IMAGE_STATUS.Loading;a.getCurrentImageDisplaySize();var d=a.getOutputImageSize(a.options.zoomFactors.length-1),ee=a.getZoomedImageBox(a.currentSize,a.currentPosition,d,c);a.loadImage(this.loadedAssets.frameUrls[this.currentRowIndex()][this.currentFrameIndex()],a.options.container,a.getInputImageSize(a.options.zoomFactors.length-1),d,(function(){a.applyPosition(),a.fullImageStatus=a.FULL_IMAGE_STATUS.Loaded}),(function(){a.fullImageStatus!==a.FULL_IMAGE_STATUS.Loaded&&(a.fullImageStatus=a.FULL_IMAGE_STATUS.NotLoaded)}),ee.focalPointOnSourceImage,null,!0,this.params.zoomJpgQlt)},Controller.prototype.zoomCenter=function(){this.zoomIn(!0)},Controller.prototype.setEventListeners=function(){this.viewModel.events.on("refreshButtonClicked",function(){this.refresh(),this.events.trigger("refreshButtonClicked")}.bind(this)),this.viewModel.events.on("zoomCenter",this.zoomCenter.bind(this)),c(window).resize(function(){if(this.initState===this.INIT_STATE.Initialized){var a=this.containers.spin.getBoundingClientRect();a.width===this.spinContainerRect.width&&a.height===this.spinContainerRect.height||this.resize()}}.bind(this));var a,d,ee=new ne(this.containers.root),te=ee.get("pinch"),ie=ee.get("pan"),se=ee.get("doubletap"),re=0,oe=0,ae=null,ce=function(a,c){var d=this.getCurrentZoomer();if(d.canZoomOut())d.moveBy(c);else if(this.frames.length>1||this.frames[this.currentRowIndex()].length>1){var ee=this.getRemoteRowIndex(re,this.getMatrixShift(this.params.reverseVerticalDirection,a.y,this.frames.length,this.spinContainerSize.height)),te=this.getRemoteFrameIndex(oe,this.getMatrixShift(this.params.reverseHorizontalDirection,a.x,this.frames[0].length,this.spinContainerSize.width));ee===this.currentRowIndex()&&te===this.currentFrameIndex()||(this.events.trigger("spun"),this.showFrame(ee,te))}}.bind(this),le=function(){ie.set({threshold:this.MIN_GESTURE_RECOGNIZE_DISTANCE}),ie.set({direction:this.isPannable()?ne.DIRECTION_ALL:ne.DIRECTION_HORIZONTAL}),ie.set({enable:this.isPannable()||this.frames[this.currentRowIndex()].length>1})}.bind(this),de=function(c){if(this.initState===this.INIT_STATE.Initialized){c.preventDefault(),c.stopPropagation();var d=this.getCurrentZoomer(),ee=1+.1*(c.detail<0||c.wheelDelta>0?1:-1);this.spinContainerRect=this.containers.spin.getBoundingClientRect(),d.fullImageStatus===d.FULL_IMAGE_STATUS.NotLoaded&&this.loadFullImage.call(this,d,this.getEventPositionRelativeToTarget(c,this.spinContainerRect)),a=d.getCurrentImageDisplaySize(),d.scale(a,ee,this.getEventPositionRelativeToTarget(c,this.spinContainerRect),false)}}.bind(this);le(),se.set({interval:500,time:500,threshold:this.MIN_GESTURE_RECOGNIZE_DISTANCE,posThreshold:100});this.viewModel.events.on("panImage",(function(a,c){var d={x:0,y:0},ee=c.split(",");-1===ee.indexOf("arrowup")&&-1===ee.indexOf("w")||(d.y=30),-1===ee.indexOf("arrowdown")&&-1===ee.indexOf("s")||(d.y=-30),-1===ee.indexOf("arrowleft")&&-1===ee.indexOf("a")||(d.x=30),-1===ee.indexOf("arrowright")&&-1===ee.indexOf("d")||(d.x=-30),ce(d,d)})),this.isPannable.subscribe(function(a){this.viewModel.isPannable(a),le()}.bind(this)),ee.on("hammer.input",function(a){a.distance<this.MIN_GESTURE_RECOGNIZE_DISTANCE&&(ae=null),null===ae&&a.distance>=this.MIN_GESTURE_RECOGNIZE_DISTANCE&&(ae=!this.isPannable()&&1===a.pointers.length&&(a.direction&ne.DIRECTION_VERTICAL)>0),ae?ee.stop():te.set({enable:a.pointers.length>1})}.bind(this)),ee.on("tap",function(a){this.initState===this.INIT_STATE.Initialized&&"mouse"===a.pointerType&&(a.target&&-1===a.target.className.indexOf("amp-overlay")||(this.spinContainerRect=this.containers.spin.getBoundingClientRect(),this.zoomIn(!0,this.getEventPositionRelativeToTarget(a,this.spinContainerRect))))}.bind(this)),ee.on("doubletap",function(a){a.preventDefault(),a.srcEvent.stopPropagation(),this.initState===this.INIT_STATE.Initialized&&"mouse"!==a.pointerType&&(this.spinContainerRect=this.containers.spin.getBoundingClientRect(),this.zoomIn(!0,this.getEventPositionRelativeToTarget(a,this.spinContainerRect)))}.bind(this)),ee.on("panstart",function(a){d=a,oe=this.currentFrameIndex(),re=this.currentRowIndex()}.bind(this)),ee.on("pan",function(a){if(this.initState===this.INIT_STATE.Initialized){a.preventDefault(),a.srcEvent.stopPropagation(),oe=oe||this.currentFrameIndex(),re=re||this.currentRowIndex(),d=d||a;var c={x:a.deltaX-d.deltaX,y:a.deltaY-d.deltaY},ee={x:a.deltaX,y:a.deltaY};d=a,ce(ee,c)}}.bind(this)),ee.on("panend",function(a){d=a,oe=this.currentFrameIndex(),re=this.currentRowIndex()}.bind(this)),ee.on("pinchstart",function(c){if(this.initState===this.INIT_STATE.Initialized){var d=this.getCurrentZoomer();d.fullImageStatus===d.FULL_IMAGE_STATUS.NotLoaded&&(this.spinContainerRect=this.containers.spin.getBoundingClientRect(),this.loadFullImage.call(this,d,this.getEventPositionRelativeToTarget(c,this.spinContainerRect))),a=d.getCurrentImageDisplaySize(),ie.set({enable:!1})}}.bind(this)),ee.on("pinch",function(c){c.preventDefault(),c.srcEvent.stopPropagation(),this.initState===this.INIT_STATE.Initialized&&this.getCurrentZoomer().scale(a,c.scale,this.getEventPositionRelativeToTarget(c,this.spinContainerRect),false)}.bind(this)),ee.on("pinchend",function(){this.initState===this.INIT_STATE.Initialized&&le()}.bind(this)),this.containers.spin.addEventListener("mousewheel",de),this.containers.spin.addEventListener("DOMMouseScroll",de),this.hasError.subscribe(function(a){this.viewModel.isErrorPageVisible(a)}.bind(this))},Controller.prototype.getMatrixShift=function(a,c,d,ee){var te=(a?-1:1)*this.params.spinSpeed*c*d/ee;return te>0?Math.floor(te):Math.ceil(te)},Controller.prototype.getRemoteFrameIndex=function(a,c){var d=(a+c)%this.frames[0].length;return d<0&&(d=this.frames[0].length+d),d},Controller.prototype.getRemoteRowIndex=function(a,c){var d=(a+c)%this.frames.length;return d<0&&(d=this.frames.length+d),d},Controller.prototype.loadAssets=function(a,c,d){this.initState=this.INIT_STATE.NotInitialized,this.loadedAssets=null,this.assetsProvider.getAssets(a,function(a){if(a.maxSize.width&&a.maxSize.height)return this.loadedAssets=a,void("function"==typeof c&&c(a));"function"==typeof d&&d()}.bind(this),d)},Controller.prototype.setAssets=function(a){this.initState=this.INIT_STATE.NotInitialized,this.loadedAssets=a},Controller})),define("spinViewer/Controller",["UnpatchedSpinViewerController"],(function(a){var c=a.prototype.updateSpinContainerSize;return a.prototype.updateSpinContainerSize=function(){if(!this.spinContainerSize)return c.call(this);var a=this.spinContainerSize;c.call(this),0===this.spinContainerSize.height&&0===this.spinContainerSize.width&&(this.spinContainerSize=a)},a})),define("bindings/fadeVisible",["ko","$"],(function(a,c){"use strict";function FadeVisible(){}return FadeVisible.prototype.init=function(d,ee){var te=ee();c(d).toggle(a.unwrap(te))},FadeVisible.prototype.update=function(d,ee){var te=ee();a.unwrap(te)?c(d).fadeIn():c(d).fadeOut()},a.bindingHandlers.fadeVisible=new FadeVisible,a.bindingHandlers.fadeVisible})),define("spinViewer/component",["$","text!spinViewerView","utils/scene7.config","utils/scene7.ImageLoader","utils/scene7.DataProvider","spinViewer/DataProvider","spinViewer/AssetsProvider","spinViewer/ViewModel","spinViewer/Controller","bindings/fadeVisible"],(function(a,c,d,ee,te,ie,ne,se,re){"use strict";return{viewModel:{createViewModel:function(c,oe){var ae=a({}),ce=a({}),le={window,root:oe.element,spin:oe.element.querySelector(".amp-spin"),images:oe.element.querySelector(".amp-spin .amp-images")},de=new d(c.scene7.imageServer,c.scene7.videoServer),ue=new te(de),he=new ie(de,ue),pe=new ne(he),me=new ee(de,c.viewer.useCors),fe=new se(ae,c.messages);c.viewer.zoomFactors.container&&(c.viewer.zoomFactors=c.viewer.zoomFactors.container);var ge=new re(pe,me,c.viewer,fe,le,ce),ve={setAssets:ge.setAssets.bind(ge),loadAssets:ge.loadAssets.bind(ge),init:ge.init.bind(ge),zoomIn:ge.zoomIn.bind(ge),zoomOut:ge.zoomOut.bind(ge),zoomReset:ge.zoomReset.bind(ge),events:ge.events};return c.api(ve),fe}},template:c,synchronous:!0}})),define("Asos.Utils.MediaPlayers",["videoPlayer/component","videoPlayer/DataMapper","videoPlayer/AssetsProvider","spinViewer/component","utils/scene7.config","utils/scene7.DataProvider","spinViewer/DataProvider","spinViewer/AssetsProvider"],(function(a,c,d,ee,te,ie,ne,se){"use strict";function MediaPlayers(){this.videoPlayer=a,this.spinViewer=ee}return MediaPlayers.prototype.getSpinViewerAssetsProvider=function(a){var c=new te(a),d=new ie(c),ee=new ne(c,d);return new se(ee)},MediaPlayers.prototype.getVideoPlayerAssetsProvider=function(a){var ee=new te(null,a),ne=new ie(ee),se=new c(ee);return new d(ee,ne,se)},new MediaPlayers})),define("ProductUtils/Window",[],(function(){return window})),define("ProductUtils/MergeJson",[],(function(){return function(a,c){var d=JSON.parse(JSON.stringify(a)),ee=JSON.parse(JSON.stringify(c));for(var te in ee)try{d[te]=ee[te]}catch(a){console.warn("couldn't merge JSONS: "+a)}return d}})),define("ProductUtils/StockPrice",["ProductUtils/Window","ProductUtils/MergeJson"],(function(a,c){return function(){this.getStockPrice=function(c,d,ee){null!=c&&a.asos.pdp.getStockPrice().then(function(a){this.successRequest.call(this,a,{callback:d,products:c})}.bind(this)).catch(ee)},this.successRequest=function(a,c){var d=this.combineData(c.products,a);c.callback(d)},this.combineData=function(a,c){var d,ee=void 0!==a.products,te=this.createVariantMap(a,ee);if(ee){for(var ie={},ne=0;ne<a.products.length;ne++)ie[a.products[ne].id]=ne;var se=[];se.length=c.length;for(var re=0;re<c.length;re++){se[ie[c[re].productId]]=c[re]}for(var oe=0;oe<a.products.length;oe++)a.products[oe]=this.mergeJsons(a.products[oe],se[oe]);d=a;for(var ae=[],ce=0;ce<a.products.length;ce++)ae.push(this.mapVariantData(a.products[ce],d.products[ce],te[a.products[ce].productId]));return d.products=ae,d}return te=te[a.id],d=this.mergeJsons(a,c[0]),this.mapVariantData(a,d,te)},this.mapVariantData=function(a,c,d){for(var ee=!1,te=0;te<a.variants.length;te++)ee||(ee=c.variants[te].isInStock),c.variants[te].variantId=c.variants[te].id,c.variants[te].sku=d[c.variants[te].id].sku,c.variants[te].size=d[c.variants[te].id].size,c.variants[te].sizeOrder=d[c.variants[te].id].sizeOrder,c.variants[te].colour=d[c.variants[te].id].colour,c.variants[te].colourWayId=d[c.variants[te].id].colourWayId,c.variants[te].isPrimary=d[c.variants[te].id].isPrimary,c.variants[te].sizeId=d[c.variants[te].id].sizeId,c.variants[te].productImage=void 0!==a.productImage?a.productImage.url:"";return c.isInStock=ee,c},this.createVariantMap=function(a,c){var d=[];if(c)for(var ee=0;ee<a.products.length;ee++)d[a.products[ee].id]=[],d=this.loopVariants(a.products[ee],d);else d[a.id]=[],d=this.loopVariants(a,d);return d},this.loopVariants=function(a,c){for(var d=0;d<a.variants.length;d++){var ee=a.variants[d].variantId;c[a.id][ee]=a.variants[d]}return c},this.mergeJsons=c}})),define("Models/VariantDecorator",[],(function(){function findIndex(a,c){for(var d=0;d<a.length;d++)if(c(a[d]))return d}return function(){this.getData=function(a,c){c=void 0!==c&&c;var d=void 0!==a.productImage?[a.productImage]:a.images,ee={};if(d)for(var te=0;te<d.length;te++){var ie=d[te];if(ie.colourWayId)void 0===ee[ie.colourWayId]&&(ee[ie.colourWayId]=ie.colour)}var ne=a.variants;ne.sort((function(a,c){var d=c.colour.localeCompare(a.colour);return 0===d?c.sizeOrder-a.sizeOrder:d}));for(var se,re=a.productId?a.productId:a.id,oe=ne.length,ae={},ce={productId:re,colours:[],isInStock:!1,price:a.productPrice},le=0;oe--;){var de=ne[oe];de.productId=re,de.ratings=a.ratings,de.brandName=a.brandName,void 0===ce.hasDifferentPrices&&(c||de.isInStock)&&(void 0===se?se=de.price.current:de.price.current.value!==se.value&&(ce.hasDifferentPrices=!0));var ue=de.isInStock;de.colourName=ee[de.colourWayId];var he=ae[de.colour];void 0===he&&(ce.colours.push({colour:de.colour,colourName:de.colourName,variants:[],colourWayId:de.colourWayId}),he=ae[de.colour]={index:le,variantsInStock:0},le++),ue&&(he.variantsInStock++,ce.isInStock||(ce.isInStock=!0)),ce.colours[he.index].variants.push(de),(void 0===he.lowestPrice||he.lowestPrice.value>de.price.current.value)&&(he.lowestPrice=de.price.current)}for(var pe=Object.keys(ae),me=pe.length-1;me>=0;me--){var fe=pe[me],ge=ae[fe],ve=findIndex(ce.colours,(function(a){return a.colour===fe}));c||0!==ge.variantsInStock?ce.colours[ve].price=ge.lowestPrice:ce.colours.splice(ve,1)}return ce}}})),define("text!Components/product-image/product-image.html",[],(function(){return'<div class="grid-row">\n  <img class="mix-match-item-thumbnail" data-bind="attr: {\n        alt: \'\',\n        src: source,\n        srcset: sourceSet,\n        sizes: size + \'px\'\n        }" />\n</div>\n'})),define("ProductUtils/ImagePresets",["PageConfig"],(function(a){return{getImageSource:function getImageSource(c,d,ee){return c+a.imagePresets[ee][d]},getImageSourceSet:function getImageSourceSet(c,d,ee){return Object.keys(a.imagePresets[ee]).filter((function(a){return a>=d})).map((function(d){return c+a.imagePresets[ee][d]+" "+d+"w"})).join(",")}}})),define("Components/product-image/product-image",["text!./product-image.html","ProductUtils/ImagePresets"],(function(a,c){return{viewModel:function ViewModel(a){this.imgUrl=a.imgUrl,this.size=a.size,this.state=a.state,this.productId=a.productId,this.context=a.context,this.productData=a.productData,this.source=c.getImageSource(this.imgUrl,this.size,a.type),this.sourceSet=c.getImageSourceSet(this.imgUrl,this.size,a.type)},template:a}})),define("Components/content/content",[],(function(){return{viewModel:function ViewModel(a){this.state=a.state,this.product=a.data}}})),define("text!Components/product-gallery/product-gallery.html",[],(function(){return'\x3c!-- ko if: !isMobile--\x3e\n    <div class="gallery-aside-wrapper">\n        \x3c!-- ko if: !preventThumbnailDescription --\x3e\n            <p id="thumbnailsDescription" data-bind="text: state.resources.pdp_media_gallery_thumbnail_instruction"></p>\n        \x3c!-- /ko --\x3e\n\n        <ul class="thumbnails" data-bind="attr: { \'aria-label\': galleryText.thumbnailLabel }" aria-describedby="thumbnailsDescription">\n            \x3c!-- ko foreach: galleryItems--\x3e\n                \x3c!-- ko if: $index() > 0  --\x3e\n                    <li class="image-thumbnail" data-bind="css: { active: $parent.thumbIndex() === $index() }, attr: { \'aria-current\': $parent.thumbIndex() === $index() }">\n                        <button data-bind="click: $parent.selectThumbnail.bind($data, $index())">\n                            <img class="gallery-image" data-bind="attr: imageSources().thumbnail"/>\n                        </button>\n                    </li>\n                \x3c!-- /ko --\x3e\n            \x3c!-- /ko --\x3e\n        </ul>\n            <div class="interactives">\n                \x3c!-- ko if : showInteractiveButtons --\x3e\n                    \x3c!-- ko if: isVideoButtonVisible --\x3e\n                        <button class="catwalk" data-bind="visible: isVideoButtonVisible(), event: { blur: onVideoButtonBlur }, click: onVideoButtonActivated, attr: { \'aria-current\': isVideoVisible, \'aria-label\': state.resources.pdp_media_video_player_label }">\n                            <span class="interactive-icon product-play" data-bind="css: { \'product-play-filled\': isVideoVisible }"></span>\n                            <span class="interactive-text" data-bind="text: state.resources.pdp_misc_video, css: { \'active\': isVideoVisible }"></span>\n                        </button>\n                    \x3c!--/ko --\x3e\n                    \x3c!-- ko if: isSpinViewerButtonVisible --\x3e\n                    <button class="spinset" data-bind="visible: isSpinViewerButtonVisible(), click: onSpinViewerButtonActivated, attr: { \'aria-current\': isSpinViewerVisible, \'aria-pressed\': isSpinViewerPressed, \'aria-label\': state.resources.pdp_media_spinset_label }">\n                        <span class="interactive-icon product-360" data-bind="css: { \'product-360-selected\': isSpinViewerVisible }"></span>\n                        <span class="interactive-text" data-bind="css: { \'active\': isSpinViewerVisible }, text: state.resources[\'pdp_misc_spinset\']"></span>\n                    </button>\n                    \x3c!--/ko --\x3e\n                \x3c!--/ko --\x3e\n                <div id="looks-button-portal-desktop"></div>\n            </div>\n    </div>\n\x3c!-- /ko --\x3e\n\n<div\n    id="product-gallery"\n    class="product-carousel"\n    role="region"\n    tabindex="-1"\n    data-bind="\n        attr: {\n            \'aria-label\': galleryText.carouselLabel, \n            \'id\': productGalleryId\n        }"\n>\n    <div class="gallery-live-region" aria-live="polite">\n        \x3c!-- ko if: ariaLiveText --\x3e\n            <span data-bind="text: ariaLiveText"></span>\n        \x3c!-- /ko --\x3e\n    </div>\n    <div class="window" data-bind="swipe">\n        <div class="selling-fast" data-bind="visible: showSellingFastLabel">\n            <span class="selling-fast__label" data-bind="text: state.resources.pdp_misc_selling_fast"></span>\n        </div>\n        \x3c!-- ko if: !isMixMatch--\x3e\n            <div id="image-overlay-slot"></div>\n        \x3c!-- /ko --\x3e\n        <div class="gallery-images" data-bind="foreach: galleryItems, css: { animate : animate() }, style: { width : galleryWidth, marginLeft : galleryPosition }">\n            <div class="image-container" data-bind="style: { width : $parent.itemWidth, display: $parent.showCarouselControls() ? \'block\' : \'none\'}, css: { \'zoomable\': $parent.imageData(), \'hide-image\': $parent.thumbIndex() !== $index() }, attr: { \'data-gallery-index\': $index, \'aria-hidden\': $parent.thumbIndex() !== $index() }">\n                <div class="asos-media spinset imageviewer" data-bind=\'component: { name: "asos-spin-viewer-prod", params: { scene7: $parent.playerParams.scene7, viewer: { zoomFactors: $parent.zoomFactors, baseJpgQlt: 80, zoomJpgQlt: 90, handleLoadingErrors: false, showHint: false, maxPixelRatio: 3 }, api: $parent.imageViewerApis()[$index()], messages: $parent.playerParams.messages } }, visible: $parent.imageViewersVisibility()[$index()]\'></div>\n                <img class="gallery-image" data-bind="attr: imageSources().hero, event: { onload: window.asos.performance.markAndMeasure(\'pdp:gallery_image_\'+$index()+\'_displayed\')}"/>\n            </div>\n        </div>\n        \x3c!-- ko if: showCarouselControls --\x3e\n            <button\n                class="arrow-button arrow-button-right"\n                aria-controls="product-gallery"\n                aria-label="pdp_media_gallery_carousel_next"\n                data-bind="\n                    click:moveRight,\n                    markAndMeasure: \'pdp:gallery_swiping_right_interactive\',\n                    attr: {\n                        \'aria-label\': state.resources.pdp_media_gallery_carousel_next,\n                        \'aria-controls\': productGalleryId\n                    }"\n            >\n                <span aria-hidden="true" class="product-chevron-right-large-outlined"></span>\n            </button>\n            <button\n                class="arrow-button arrow-button-left"\n                aria-controls="product-gallery"\n                aria-label="pdp_media_gallery_carousel_previous"\n                data-bind="\n                    click: moveLeft,\n                    markAndMeasure: \'pdp:gallery_swiping_left_interactive\',\n                    attr: {\n                        \'aria-label\': state.resources.pdp_media_gallery_carousel_previous,\n                        \'aria-controls\': productGalleryId\n                    }"\n            >\n                <span aria-hidden="true" class="product-chevron-left-large-outlined"></span>\n            </button>\n            \x3c!-- ko if: isMobile--\x3e\n                <div class="carousel-bullets">\n                    <ul id="mobile-gallery-bullets" data-bind="foreach: galleryItems, attr: { \'aria-label\': selectImageAlt }">\n                        \x3c!-- ko if: $index() > 0 --\x3e\n                            <li data-bind="css: { active: $parent.thumbIndex() === $index() }">\n                                <button aria-describedby="mobile-gallery-bullets" data-bind="click: $parent.selectThumbnail.bind($data, $index()), attr: { \'aria-current\': ($parent.thumbIndex() === $index()).toString() }"></button>\n                            </li>\n                        \x3c!-- /ko --\x3e\n                    </ul>\n                </div>\n            \x3c!-- /ko --\x3e\n        \x3c!-- /ko --\x3e\n    </div>\n    <div class="asos-media catwalk" style="display: none" data-bind=\'component: { name: "asos-video-player-prod", params: { scene7: playerParams.scene7, player: { startInFullScreen: startVideoInFullScreen, closeOnFullScreenExited: closeVideoOnFullScreenExited, initialLoopCount: 2 }, api: videoPlayerApi, messages: playerParams.messages } }, visible: isVideoVisible\'></div>\n    <div class="asos-media spinset spinviewer" style="display: none" data-bind=\'component: { name: "asos-spin-viewer-prod", params: { scene7: playerParams.scene7, viewer: { spinSpeed: spinSpeed, zoomFactors: zoomFactors, reverseVerticalDirection: false, reverseHorizontalDirection: false, baseJpgQlt: 80, zoomJpgQlt: 90, showHint: showSpinViewerContainerHint, useInitialAnimation: true, animationIntervalStart: 100, animationIntervalPeak: 100, animationFramesCount: 5, preloadingTimeout: 30000 }, api: spinViewerApi, messages: playerParams.messages } }, visible: isSpinViewerVisible, css: { "zoomable": isSpinViewerLoadedWithoutErrors }\'></div>\n</div>\n\n\x3c!-- ko if: isMobile--\x3e\n    <div class="gallery-aside-wrapper">\n        <div class="interactives">\n            <div id="looks-button-portal"></div>\n            \x3c!-- ko if : showInteractiveButtons --\x3e\n                <button class="catwalk" data-bind="visible: isVideoButtonVisible(), click: onVideoButtonActivated, attr: { \'aria-current\': isVideoVisible, \'aria-label\': state.resources.pdp_media_video_player_label }">\n                    <span class="interactive-icon product-play" data-bind="css: { \'product-play-filled\': isVideoVisible }"></span>\n                    <span class="interactive-text" data-bind="text: state.resources.pdp_misc_video, css: { \'active\': isVideoVisible }"></span>\n                </button>\n                <button class="spinset" data-bind="visible: isSpinViewerButtonVisible(), click: onSpinViewerButtonActivated, attr: { \'aria-current\': isSpinViewerVisible, \'aria-pressed\': isSpinViewerPressed, \'aria-label\': state.resources.pdp_media_spinset_label }">\n                    <span class="interactive-icon product-360" data-bind="css: { \'product-returns\': isSpinViewerVisible }"></span>\n                    <span class="interactive-text" data-bind="css: { \'active\': isSpinViewerVisible }, text: spinViewerLabelText"></span>\n                </button>\n            \x3c!--/ko --\x3e\n        </div>\n    </div>\n\x3c!-- /ko --\x3e\n'})),define("ProductUtils/NewRelicLogger",["PageConfig"],(function(a){var NewRelicLogger=function(){var c;this.init=function(a){c=a},this.logError=function(d,ee){window.newrelic&&(ee.pageVersion=a.version,ee.pageUrl=window.location.href,ee.pageType=c,ee.codebase="Knockout",window.newrelic.addPageAction(d.message,ee))}};return NewRelicLogger.prototype.PAGE_TYPE={PRD:"ProductPage.SingleProduct",GRP:"ProductPage.MixAndMatch"},NewRelicLogger.prototype.ERROR_TYPE={AjaxError:"Ajax Error",ParseError:"Parse Error",UserActionFailed:"User Action Failed"},new NewRelicLogger})),define("asos-web-seo-path",[],(function(){"use strict";var a=[["А","A"],["а","a"],["Б","B"],["б","b"],["В","V"],["в","v"],["Г","G"],["г","g"],["Д","D"],["д","d"],["Е","E"],["е","e"],["Ё","Yo"],["ё","yo"],["Ж","Zh"],["ж","zh"],["З","Z"],["з","z"],["И","I"],["и","i"],["Й","J"],["й","j"],["К","K"],["к","k"],["Л","L"],["л","l"],["М","M"],["м","m"],["Н","N"],["н","n"],["О","O"],["о","o"],["П","P"],["п","p"],["Р","R"],["р","r"],["С","S"],["с","s"],["Т","T"],["т","t"],["У","U"],["у","u"],["Ф","F"],["ф","f"],["Х","H"],["х","h"],["Ц","Ts"],["ц","ts"],["Ч","Ch"],["ч","ch"],["Ш","Sh"],["ш","sh"],["Щ","Sch"],["щ","sch"],["Ъ",""],["ъ",""],["Ы","Y"],["ы","y"],["Ь",""],["ь",""],["Э","E"],["э","e"],["Ю","Yu"],["ю","yu"],["Я","Ya"],["я","ya"]];function convertCyrillicToRoman(c){return Object.values(c).map((function(c){var d=a.find((function(a){return a[0]===c}));return d?d[1]:c})).join("")}function sanitiseName(a){return function removeDiacritics(a){return Object.values(a.normalize("NFD")).map((function(a){if(a.match(/[0-9A-Za-z \-/.]/g))return a})).join("").normalize("NFC")}(a.trim()).replace(/\//g,"-").replace(/\s/g,"-").replace(/-+/g,"-").replace(/\./g,"").replace(/^-/,"").replace(/-$/,"").toLowerCase()}return function createSeoPath(a){return function(c,d,ee){if("function"!=typeof"".normalize)return"";if(!c)return a&&a.error("createSeoPath - productName was not passed in"),"";var te=function getRomanNames(a,c,d){var ee=a,te=c;return d&&"ru-ru"===d.toLowerCase()&&(ee=convertCyrillicToRoman(a),te=convertCyrillicToRoman(c)),{romanProductName:ee,romanBrandName:te}}(c,d,ee),ie=te.romanProductName,ne=te.romanBrandName,se=sanitiseName(ie),re=sanitiseName(ne);return"".concat(re,"/").concat(se)}}})),define("ProductUtils/UrlUtils",["PageConfig","ProductUtils/NewRelicLogger","asos-web-seo-path","ProductUtils/Window"],(function(a,c,d,ee){return function(){var te=d();this.formatUrl=function(a){return a?"http"===a.substring(0,4)?a.replace("http:","https:"):"/"===a.substring(0,1)?a:"//"+a:a},this.getUrlParam=function(a,c){if(c||(c=ee.location.href),"ctaref"===a.toLowerCase()&&ee.location.hash){var d=ee.s.getQueryParamValue("ctaref",!0).toLowerCase();if(d)return d}a=a.replace(/[[]/,"\\[").replace(/[\]]/,"\\]");var te=new RegExp("[\\?&]"+a+"=([^&#]*)","i").exec(c);return null===te?null:decodeURIComponent(te[1].replace(/\+/g," "))},this.getVariantFromUrl=function(a,c){var d=a.split("?")[0];if((d=null!=d?d.split("/prd/"):null).length>0&&(d=parseInt(d[1])),d||(d=parseInt(this.getUrlParam("iid",a))),!d)return null;for(var ee=0;ee<c.length;ee++)if(c[ee].variantId===d)return c[ee];return null},this.getProductUrl=function(d,ee,ie){if(!ie)return c.logError(new TypeError("ProductId was not provided")),a.siteDomain;var ne="";return d&&ee?ne="/"+te(d,ee,a.language):c.logError(new TypeError("missing brand name or product name, returning generic link"),{productId:ie}),a.siteDomain+ne+"/prd/"+ie}}})),define("ProductUtils/Analytics/Utils/Common",["ProductUtils/UrlUtils"],(function(a){var c=new a;function addMerchEvarToProduct(a,c){return/.*;;;;evar/i.test(a)?Array.isArray(c)?c.forEach((function(c){a=a+"|"+c})):a=a+"|"+c:Array.isArray(c)?c.forEach((function(c){a=a+"|"+c})):a=a+";;;;"+c,a}return{getChannel:function getChannel(){var a=c.getUrlParam("SearchQuery"),d=c.getUrlParam("cid");if(d)return d;if(null!==a)return"search";var ee=c.getUrlParam("ctaref");if(ee){if(/bag/i.test(ee))return"basket page";if(/saved items/i.test(ee))return"saved items";if(/wishlists/i.test(ee))return"wishlists"}return"product page"},getLinkTrackEvents:function getLinkTrackEvents(a){return a.map((function(a){return a.split("=")[0]}))},getGlobalEvars:function getGlobalEvars(){return["eVar1","eVar6","eVar10","eVar15","eVar17","eVar18","eVar19","eVar20","eVar29","eVar30","eVar45","eVar47","eVar60","eVar61","eVar69","eVar112","eVar113","eVar198"]},addMerchEVarToProducts:function addMerchEVarToProducts(a,c,d){return(a||"").split(",;").map((function(a){if(d){var ee=a.split(";;;;")[0];return";"===ee[0]&&(ee=ee.substr(1)),ee===String(d)?addMerchEvarToProduct(a,c):a}return addMerchEvarToProduct(a,c)})).join(",;")},getProductAreaAttribute:function getProductAreaAttribute(a){return{oosproduct:"oos product page",main:"product page"}[a.toLowerCase()]},getAsosFulfilsPrefix:function getAsosFulfilsPrefix(a,c){return a&&"asos"!==a&&c!==a?"afs - ":""}}})),define("ProductUtils/calculateDiscount",[],(function(){return function(a,c){return Math.floor((1e3*c-1e3*a)/(10*c)).toString()}})),define("ProductUtils/Analytics/Utils/GetAndPersistValue",[],(function(){return function(a){var c=window.s.getAndPersistValue(null,a);return"no value"===c||""===c?null:c}})),define("ProductUtils/Analytics/AddToBag",["PageConfig","ProductUtils/Analytics/Utils/Common","ProductUtils/calculateDiscount","ProductUtils/Analytics/Utils/GetAndPersistValue"],(function(a,c,d,ee){return function(te){var ie=window.s,ne={},se=te.commons,re=te.context.toLowerCase(),oe="add to bag",ae=[],ce=[],le=["products","prop38","eVar66","eVar67","prop75","eVar91","eVar92","eVar151","eVar152"].concat(c.getGlobalEvars());function sendLocalAnalytics(){!function sendAnalytics(a,d,ee,te,ie,ne){a.events=ie.join(","),d.linkTrackVars=ee.setLinkTrackVars(ne),d.linkTrackEvents=ee.setLinkTrackEvents(c.getLinkTrackEvents(ie)),a.tl(!0,"o",te,d)}(ie,ne,se,oe,ce,le)}for(var de=0;de<te.variants.length;de++)ae.push(te.variants[de].variantId);ie.products=";"+ae.join(",;");var ue=c.getProductAreaAttribute(te.addToBagType);if(ie.eVar92=ue,ie.products=c.addMerchEVarToProducts(ie.products,"eVar6="+ie.eVar6),ie.products=c.addMerchEVarToProducts(ie.products,"eVar13="+ue),"mix&match"===a.pageType){"main"===te.addToBagType&&(ie.products=c.addMerchEVarToProducts(ie.products,"eVar182=mix & match"));for(var he=0;he<te.variants.length;he++)ie.products=c.addMerchEVarToProducts(ie.products,"eVar195=mix&match rating and review impression "+Boolean(te.variants[he].ratings),te.variants[he].variantId)}else{for(var pe="asos",me="primary",fe=0,ge=null;fe<te.variants.length;fe++)(ge=te.variants[fe]).source&&(me=ge.source.id),ge.seller&&(pe=ge.seller.id.toLowerCase());if(te.variants.length){var ve=c.getAsosFulfilsPrefix(pe,me.toLowerCase());ie.products=c.addMerchEVarToProducts(ie.products,"eVar211="+ve+me.toLowerCase(),ge.variantId),ie.eVar212&&(ie.products=c.addMerchEVarToProducts(ie.products,"eVar213="+ie.eVar212)),ie.products=c.addMerchEVarToProducts(ie.products,"eVar215="+ve+pe.toLowerCase(),ge.variantId)}te.saveCount&&te.saveCount.isShowing&&(ie.products=c.addMerchEVarToProducts(ie.products,"eVar228="+te.saveCount.value))}if(te.variants.length&&(ie.products=c.addMerchEVarToProducts(ie.products,"eVar184="+te.variants[0].sizeGuideOpened()+"-"+te.variants[0].brandName)),"addtobagerror"===re?(oe="add to bag error",ce.push("event149"),ie.prop38=te.errorId+"|"+te.errorCode):(ce.push("event150="+te.variants.length),ce.push("event151="+function getTotalPrice(a){return a.reduce((function(a,c){return a+(void 0===c.price.current?c.price:c.price.current.value)}),0)}(te.variants)),ce.push("scAdd"),ce.push("scOpen")),"product page"===ue){if(te.variants.length){if(te.ratings&&Object.keys(te.ratings).length){var be=(te.ratings.averageOverallRating/5).toFixed(2),ye=te.ratings.totalReviewCount;if(ie.products=c.addMerchEVarToProducts(ie.products,["eVar189="+be,"eVar190="+ye]),ce.push("event257="+be),ce.push("event258="+ye),te.ratings.percentageRecommended){var Se=te.ratings.percentageRecommended;ie.products=c.addMerchEVarToProducts(ie.products,"eVar191="+Se),ce.push("event259="+Se)}if(te.ratings.mostRecent){var we=(te.ratings.mostRecent.rating/5).toFixed(2);ie.products=c.addMerchEVarToProducts(ie.products,"eVar202="+we),ce.push("event274="+we)}if(te.ratings.subRatings&&te.ratings.subRatings.length){var xe=te.ratings.subRatings[0],Ie=(xe.percentage/100).toFixed(2);ie.products=c.addMerchEVarToProducts(ie.products,"eVar192="+xe.id+" "+Ie),ce.push("event260="+Ie)}}else if(te.ratings&&"product"===a.pageType){var Pe="value not in response";ie.products=c.addMerchEVarToProducts(ie.products,["eVar189="+Pe,"eVar190="+Pe,"eVar191="+Pe,"eVar192="+Pe,"eVar202="+Pe])}if(te.variants[0].priceObj.rrp)var Te=te.variants[0].priceObj.rrp.value;var ze=te.variants[0].priceObj.current.value;if(Te)ie.eVar161=d(ze,Te);else{var Ee=te.variants[0].priceObj.previous.value;ie.eVar161=d(ze,Ee)}te.variants[0].sellingFast&&(ie.products=c.addMerchEVarToProducts(ie.products,"eVar151=selling fast"))}if(ie.eVar230){var Ce=ee("gpv_eVar243");ie.products=c.addMerchEVarToProducts(ie.products,"eVar243="+Ce)}ie.gpv_eVar234&&(ie.products=c.addMerchEVarToProducts(ie.products,"eVar234="+ie.gpv_eVar234)),le=le.concat(["prop36","eVar50","eVar51","eVar150","eVar161","eVar231"]),sendLocalAnalytics()}else sendLocalAnalytics()}})),define("Providers/SdkProvider",["Promise"],(function(a){function getSdk(c){return function(){return new a((function(a){var resolveSdk=function(){a(window.asos.sdk[c])};window.asos.sdk&&window.asos.sdk[c]?resolveSdk():window.asos.eventBus.once(c+"-sdk-ready",(function(){resolveSdk()}))}))}}return{getSavedItems:getSdk("savedItems"),getBag:getSdk("bag"),getIdentity:getSdk("identity"),getFeatures:getSdk("features")}})),define("Providers/FeaturesProvider",["Providers/SdkProvider","Promise"],(function(a,c){var d,ee,te=new c((function(a){d=a})),ie=new c((function(a){ee=a})),getFeatureFromSdk=function(){return{isEnabled:function(){return!1},getVariables:function(){return null}}},trackFromSdk=function(){},activateFromSdk=function(){};return a.getFeatures().then((function(a){a.onReady().then((function(){getFeatureFromSdk=a.getFeature,trackFromSdk=a.track,activateFromSdk=a.activate,d(),setTimeout(ee,0)}))})),{getFeature:function getFeature(a,c,d){return getFeatureFromSdk(a,c,d)},onReady:function onReady(){return te},onComplete:function onComplete(){return ie},track:function track(a,c,d){return trackFromSdk(a,c,d)},activate:function activate(a,c,d){return activateFromSdk(a,c,d)}}})),define("ProductUtils/Analytics/PageInteraction",["Promise","Providers/FeaturesProvider","ProductUtils/Analytics/Utils/Common","ProductUtils/Window"],(function(a,c,d,ee){return function(te){var ie={},ne=te.commons,se=[],re=te.eventData.context.toLowerCase(),oe=ee.s,ae=new a((function(a){c.onReady().then((function(){var d=c.getFeature("pdp-track-product-image-interactions");a(d.isEnabled())}))}));function fireAnalytics(a){oe.events=se.join(","),ie.linkTrackVars=ne.setLinkTrackVars(["prop15","eVar183"].concat(d.getGlobalEvars())),ie.linkTrackEvents=ne.setLinkTrackEvents(d.getLinkTrackEvents(se)),oe.tl(!0,"o",a,ie)}function getSelectedProductVariants(a){var c=a.filter((function(a){if(a.id===te.eventData.productIID)return!0}));return c.length>0?c[0].variants:[]}function fireImageEvent(){ae.then((function(a){a&&(oe.prop15=re,fireAnalytics(re))}))}te.eventData.productIID&&(oe.products=";"+te.eventData.productIID),se.push("event18"),{launchsizeguide:function fireSizeGuideEvent(){oe.prop15="launch size guide",se.push("event103"),fireAnalytics("size guide click")},freedeliveryandreturns:function fireDeliveryAndReturnsEvent(){oe.prop15="free delivery and returns",se.push("event95"),fireAnalytics("free delivery and returns click")},shippingrestrictions:function fireShippingRestrictionsEvent(){void 0===ee.trackingShippingRestrictionsClick&&(ee.trackingShippingRestrictionsClick=1,oe.prop15="shipping restrictions",fireAnalytics("shipping restrictions click"))},showmore:function fireShowMoreEvent(){void 0===ee.trackingEventMore&&(ee.trackingEventMore=1,oe.prop15="show more",fireAnalytics("show more click"))},showless:function fireShowLessEvent(){void 0===ee.trackingEventLess&&(ee.trackingEventLess=1,oe.prop15="show less",fireAnalytics("show less click"))},openmodal:function fireOpenMixAndMatchModalEvent(){var a=ee.asos.pdp.config.product.products,c=function getTotalInStock(a){return a.filter((function(a){return!0===a.isInStock})).length}(getSelectedProductVariants(a)),d=getSelectedProductVariants(a).length,ie=0===d?"0":(100*(c/d)).toFixed(2)+"%|";te.eventData.modalType&&"mixAndMatch"===te.eventData.modalType&&(oe.prop15="mix and match|open modal",oe.eVar31=getSelectedProductVariants(a).length+"|"+c+"|"+ie+"null|null|null|null|null|null"),fireAnalytics("mix and match modal click")},chevronclick:function fireChevronClickEvent(){ae.then((function(a){a&&void 0===ee.trackingChangeThumbnail&&(ee.trackingChangeThumbnail=1,oe.prop15="product chevron click",fireAnalytics("product chevron click"))}))},"360launch":fireImageEvent,"360zoom":fireImageEvent,thumbnailclick:fireImageEvent,video:function fireVideoEvent(){ae.then((function(a){a&&(oe.prop15="video progress "+te.eventData.videoEvent,fireAnalytics(re))}))},ingredientsbuttonclick:function fireIngredientsButtonClickEvent(){oe.prop15="ingredients list",fireAnalytics(re)}}[re]()}})),define("ProductUtils/Analytics/Utils/PageLoad",["ProductUtils/Window","Promise"],(function(a,c){return new c((function(c){a.asos.eventBus.addListener("pageLoadAnalyticsFired",(function(){c()}))}))})),define("ProductUtils/Analytics/CustomLinkEvent",["ProductUtils/Analytics/Utils/Common","ProductUtils/Window","ProductUtils/Analytics/Utils/PageLoad","PageConfig"],(function(a,c,d,ee){return function(te){var ie=te.commons,ne=te.eventName.toLowerCase(),se=c.s;({fireflexfulfilmentanalyticsevent:function fireFlexFulfilmentAnalyticsEvent(){var c="primary",ne="asos",re=[],oe=te.variant.source,ae=te.variant.seller,ce=!1;if(oe&&(c=oe.id.toLowerCase(),-1===re.indexOf("event288")&&(re.push("event288"),ce=!0)),ae&&(ne=ae.id.toLowerCase(),-1===re.indexOf("event288")&&(re.push("event288"),ce=!0)),"mix&match"===ee.pageType||oe||ae||-1!==re.indexOf("event303")||(re.push("event303"),ce=!0),ce){var le=a.getAsosFulfilsPrefix(ne,c);se.eVar210=te.variant.id+":"+le+c,se.eVar214=te.variant.id+":"+le+ne,function fireAnalytics(c,ee,te){d.then((function(){se.events=ee.join(",");var d={linkTrackVars:ie.setLinkTrackVars(te.concat(a.getGlobalEvars())),linkTrackEvents:ie.setLinkTrackEvents(a.getLinkTrackEvents(ee))};se.tl(!0,"o",c,d)}))}("sourcing location messaging Impression",re,["eVar210","eVar212","eVar214"])}}})[ne]()}})),define("ProductUtils/Analytics",["ProductUtils/Analytics/AddToBag","ProductUtils/Analytics/PageInteraction","ProductUtils/Analytics/CustomLinkEvent","Providers/FeaturesProvider","ProductUtils/Window"],(function(a,c,d,ee,te){return new function(){var ie;window.CommonAnalytics&&(ie=new window.CommonAnalytics),this.firePageInteraction=function(a){c({eventData:a,commons:ie})},this.normalizeError=function(a,c){var d=[{errorCode:null,errorMessage:c}];return a.message=Array.isArray(a.message)?a.message:d,a},this.addVariants=function(c,d,ne,se,re){c=void 0===c.length?[c]:c,void 0===ne&&(ne="main"),function isSaveCountFeatureEnabled(){return ee.onReady().then((function(){return ee.getFeature("pdp-save-count").isEnabled()}))}().then((function(ee){d?a({context:"addToBagError",addToBagType:ne,variants:c,errorCode:d.message[0].errorCode,errorId:d.message[0].errorMessage,commons:ie,ratings:se,saveCount:ee?re:null}):(a({context:"addToBag",addToBagType:ne,variants:c,commons:ie,ratings:se,saveCount:ee?re:null}),te.asos.eventBus.emit("fireAddToBagMarketingEvent",c))}))},this.fireFlexFulfilmentAnalyticsEvent=function(a){d({commons:ie,eventName:"fireFlexFulfilmentAnalyticsEvent",variant:a})}}})),define("ProductUtils/Browser",["ko","ProductUtils/Window"],(function(a,c){var d="SMALL_VIEWPORT",ee="MEDIUM_VIEWPORT",te="LARGE_VIEWPORT",ie={medium:c.matchMedia("(min-width: 720px)"),large:c.matchMedia("(min-width: 1024px)")},ne=a.observable();function onResize(){ie.large.matches?ne(te):ie.medium.matches?ne(ee):ne(d)}return ie.medium.addListener(onResize),ie.large.addListener(onResize),onResize(),{isOnline:function isOnline(){return!c.navigator||c.navigator.onLine},viewportSize:ne,isUpToViewport:function isUpToViewport(c){return a.computed((function(){var a=!1;switch(c){case d:a=ne()===d;break;case ee:a=[d,ee].indexOf(ne())>-1;break;case te:a=[d,ee,te].indexOf(ne())>-1}return a}))},viewports:{SMALL_VIEWPORT:d,MEDIUM_VIEWPORT:ee,LARGE_VIEWPORT:te}}})),define("Components/product-gallery/product-gallery",["ko","$","text!./product-gallery.html","PageConfig","hammer","Asos.Utils.MediaPlayers","ProductUtils/Analytics","ProductUtils/UrlUtils","ProductUtils/Browser","ProductUtils/ImagePresets","ProductUtils/Window"],(function(a,c,d,ee,te,ie,ne,se,re,oe,ae){return{viewModel:function ViewModel(c){var d=c.state;this.product=c.data.product,this.productGalleryId="product-gallery"+(c.data.product?"":"-modal");var ce=c.data.images;this.galleryItems=a.observableArray(),this.galleryWidth=a.observable(),this.itemWidth=a.observable(),this.itemWidthValue=a.observable(),this.galleryPosition=a.observable(),this.galleryIndex=a.observable(0),this.animate=a.observable(!1),this.thumbIndex=a.observable(0),this.isInStock=a.observable(!1),this.isMobile="mobile"===ee.platform,this.ariaLiveText=a.observable(""),this.isSmallViewport=re.isUpToViewport(re.viewports.SMALL_VIEWPORT),this.preventThumbnailDescription=c.data.preventThumbnailDescription,this.isMixMatch=c.data.isMixMatch;var le=new se,de={imageChanged:!1,thumbnailClick:!1,imageViewerZoomIn:!1,spinViewerInit:!1,spinViewerSpin:!1,spinViewerZoomIn:!1,videoPlayerInit:!1,videoProgress:{50:!1,100:!1}};this.checkIfInStockAndSetFlag=function(){this.isInStock(!d.productData||d.productData.isInStock)},this.getVisibleImages=function(c){var d=c.filter((function(a){return!0===a.isVisible}));if(!d[0].colourWayId||null===d[0].colourWayId){var ee=a.utils.arrayFirst(c,(function(a){return a.isPrimary}));if(ee||(ee=a.utils.arrayFirst(c,(function(a){return a.colourWayId&&null!==a.colourWayId}))),ee){var te=d.indexOf(ee);te>=0&&d.splice(te,1),d.splice(0,0,ee)}}return d};var ue,he=this.getVisibleImages(ce);this.appendImageSources=function(c){return c.map(function(c,d){var ee=function(){var a=0===d?this.colourOptionImage().url:c.url;return{thumbnail:{sizes:"40px",alt:this.getThumbnailAlt(d+1),src:oe.getImageSource(a,40,"thumbnail"),srcset:oe.getImageSourceSet(a,40,"thumbnail")},hero:{sizes:"(max-width: 720px) 100vw, (min-width: 720px) 513px",alt:this.getImageAlt(d+1),src:oe.getImageSource(a,513,"hero"),srcset:oe.getImageSourceSet(a,513,"hero")}}}.bind(this);return c.imageSources=0===d?a.computed(ee):ee,c}.bind(this))}.bind(this),this.getThumbnailAlt=function(a){return d.resources.pdp_media_gallery_thumbnail_count.replace("%{index}",a).replace("%{total}",he.length)}.bind(this),this.getImageAlt=function(a){return(this.product?this.product.name:c.data.productName)+", "+d.resources.pdp_misc_count.replace("%{index}",a).replace("%{total}",he.length)}.bind(this),this.selectImageAlt=d.resources.pdp_media_gallery_select_image,d.mainImage=this.colourOptionImage=a.observable(he[0]),this.init=function(){this.galleryItems(this.shuffleLastImage(this.appendImageSources(he))),this.galleryWidth(this.getGalleryWidth()),this.itemWidth(this.getItemWidth()),this.setSwipe(),this.setImageViewers(),this.setGalleryPosition(1)},this.setGalleryPosition=function(a){this.galleryIndex(a),0===a?this.thumbIndex(this.galleryItems().length-1):this.thumbIndex(a),this.galleryPosition("-"+100*Math.abs(this.galleryIndex())+"%")},this.getItemWidth=function(){return 100/this.galleryItems().length+"%"},this.getGalleryWidth=function(){return 100*this.galleryItems().length+"%"},this.shuffleLastImage=function(a){var c=a,d=a[a.length-1];return c.unshift(d),c},this.moveLeft=function(){return this.resetImageViewer(),0===this.galleryIndex()?(this.animate(!1),this.setGalleryPosition(this.galleryItems().length-1),setTimeout(function(){this.animate(!0),this.setGalleryPosition(this.galleryItems().length-2),de.imageChanged||(ne.firePageInteraction({context:"chevronClick",productIID:c.data.id}),de.imageChanged=!0)}.bind(this),10),!1):(this.animate(!0),this.setGalleryPosition(this.galleryIndex()-1),de.imageChanged||(ne.firePageInteraction({context:"chevronClick",productIID:c.data.id}),de.imageChanged=!0),!1)},this.moveRight=function(){return this.resetImageViewer(),this.galleryIndex()===this.galleryItems().length-1?(this.animate(!1),this.setGalleryPosition(0),setTimeout(function(){this.animate(!0),this.setGalleryPosition(1),de.imageChanged||(ne.firePageInteraction({context:"chevronClick",productIID:c.data.id}),de.imageChanged=!0)}.bind(this),10),!1):(this.animate(!0),this.setGalleryPosition(this.galleryIndex()+1),de.imageChanged||(ne.firePageInteraction({context:"chevronClick",productIID:c.data.id}),de.imageChanged=!0),!1)},this.selectThumbnail=function(a,d){this.exitVideo(),this.exitSpinViewer(),this.resetImageViewer(),this.animate(!1),this.setGalleryPosition(a),!0===d||de.thumbnailClick||(ne.firePageInteraction({context:"thumbnailClick",productIID:c.data.id}),de.thumbnailClick=!0)}.bind(this),this.trySetColour=function(a){var c=function findImageIndex(a){for(var c=-1,d=0;d<ce.length;d++)if(ce[d].colourWayId===a){c=d;break}return c}(a);if(-1!==c){this.colourOptionImage(ce[c]),this.exitVideo(),this.exitSpinViewer(),this.setGalleryPosition(1),this.imageViewersVisibility()[1]&&this.initImageViewer(1)}},ae.asos.eventBus.addListener("setProductImage",function(a){this.trySetColour(a)}.bind(this)),this.trySetProductImage=function(a){for(var c=1,d=0;d<ce.length;d++)if(ce[d].productId===a){c=d+1;break}this.setGalleryPosition(c)},this.videoPlayerApi=a.observable(),this.exitVideo=function(){if(this.isVideoVisible(!1),this.videoPlayerApi()&&this.videoPlayerApi().stop)try{this.videoPlayerApi().stop(),ae.asos.eventBus.emit("videoPlaybackStopped")}catch(a){console.warn("could not stop video: "+a)}},this.keydownEventListener=function(){var a;document.addEventListener("keydown",(a=function(c){"Escape"!==c.key&&27!==c.keyCode||(this.exitVideo(),document.removeEventListener("keydown",a))}).bind(this))},this.keydownEventListener(),document.body.addEventListener("modalClosed",function(){this.exitVideo()}.bind(this)),this.startVideoInFullScreen=this.isMobile,this.closeVideoOnFullScreenExited=this.isMobile,this.canDisplayVideoButton=a.observable(!1),this.isVideoVisible=a.observable(!1),this.playerParams=c.data.playerParams,this.isVideoButtonVisible=a.computed(function(){return this.canDisplayVideoButton()&&this.isInStock()}.bind(this)),this.playerParams.messages={errorHeaderText:d.resources.pdp_media_video_player_error_header,errorMessageText:d.resources.pdp_media_video_player_error_message,spinsetErrorMessageText:d.resources.pdp_media_spinset_error_message,refreshButtonText:d.resources.pdp_media_video_player_refresh_button,unsupportedHeaderText:d.resources.pdp_media_video_player_unsupported_header,unsupportedMessageText:d.resources.pdp_media_video_player_unsupported_message,closeButtonText:d.resources.pdp_media_video_player_close_button,hintDragText:d.resources.pdp_media_spinset_hint_drag,hintTapText:d.resources.pdp_media_spinset_hint_tap,zoomHint:d.resources.pdp_media_gallery_zoom_hint,zoomOneHundred:d.resources.pdp_media_gallery_zoom_one_hundred,zoomTwoHundred:d.resources.pdp_media_gallery_zoom_two_hundred,zoomFourHundred:d.resources.pdp_media_gallery_zoom_four_hundred},this.onVideoButtonActivated=function(){de.videoFirstPlaybackCompleted=!1,this.isVideoVisible()||(this.resetImageViewer(),this.isVideoVisible(!0),this.exitSpinViewer(),this.videoPlayerApi().start(ue),ae.asos.eventBus.emit("videoPlaybackStarted"),this.ariaLiveText(d.resources.accessibility_pdp_video_playing),de.videoPlayerInit||(ne.firePageInteraction({context:"video",productIID:c.data.id,videoEvent:"start"}),de.videoPlayerInit=!0))},this.onVideoButtonBlur=function(){this.ariaLiveText("")},this.videoPlayerApi.subscribe(function(a){a.events.on("playerExitRequested allLoopsEnded",function(){this.exitVideo()}.bind(this)),a.events.on("progress",(function(a,d){if(d.detail.value)for(var ee in de.videoProgress){var te=parseInt(ee,10);!de.videoProgress[ee]&&d.detail.value>=te&&(de.videoProgress[ee]=!0,ne.firePageInteraction({context:"video",productIID:c.data.id,videoEvent:ee}))}}));c.data.media&&c.data.media.catwalkUrl&&ie.getVideoPlayerAssetsProvider(c.data.playerParams.scene7.videoServer).getAssets(le.formatUrl(c.data.media.catwalkUrl),{formats:["mp4"],preferredFPS:25,preferredBitrates:{720:12e3}}).then(function(a){ue=a,this.canDisplayVideoButton(!0),this.checkIfInStockAndSetFlag()}.bind(this))}.bind(this)),this.spinViewerApi=a.observable(),this.exitSpinViewer=function(){this.spinViewerApi()&&this.spinViewerApi().zoomReset(),this.isSpinViewerVisible(!1)},this.spinSpeed=this.isMobile?1.5:3,this.showSpinViewerContainerHint=!this.isMobile,this.zoomFactors=[.5,1],this.isSpinViewerButtonVisible=a.observable(!1),this.isSpinViewerVisible=a.observable(!1),this.isSpinViewerPressed=a.computed(function(){if(this.isMobile)return this.isSpinViewerVisible().toString()}.bind(this)),this.isSpinViewerLoadedWithoutErrors=a.observable(!1),this.spinViewerLabelText=a.observable(d.resources.pdp_misc_spinset),this.onSpinViewerButtonActivated=function(){this.spinViewerLabelText(d.resources.pdp_misc_gallery),this.isSpinViewerVisible()?this.isMobile&&(this.spinViewerLabelText(d.resources.pdp_misc_spinset),this.exitSpinViewer()):(this.resetImageViewer(),this.exitVideo(),this.isSpinViewerVisible(!0),this.spinViewerApi().init(),de.spinViewerInit||(ne.firePageInteraction({context:"360Launch",productIID:c.data.id}),de.spinViewerInit=!0))},this.showCarouselControls=a.computed(function(){return!this.isVideoVisible()&&!this.isSpinViewerVisible()}.bind(this)),this.imageData=a.observable(),this.imageViewerApis=a.observableArray([]),this.imageViewersVisibility=a.observableArray([]),this.areAllImageViewerApisReady=function(){for(var a=0;a<this.imageViewerApis().length;a++)if(!this.imageViewerApis()[a]())return!1;return!0},this.initImageViewer=function(a){var d=this.imageViewersVisibility(),ee=this.imageData(),te=this.imageViewerApis()[a](),ie=c.data.rootElement.querySelector('.image-container[data-gallery-index="'+a+'"] img.gallery-image');if(ie.complete){if(ie.complete&&te&&ee){d[a]=!0,this.imageViewersVisibility(d);var ne=ie.cloneNode();ne.style.visibility="visible",te.setAssets(ee[this.getImageIndexFromGalleryIndex(a)]),te.init(null,ne),ie.style.visibility="hidden"}}else ie.onload=this.initImageViewer.bind(this,a)},this.loadImagesMetadata=function(a){ie.getSpinViewerAssetsProvider(c.data.playerParams.scene7.imageServer).getAssets(a,function(a){this.imageData(a),this.checkIfInStockAndSetFlag()}.bind(this))},this.imageData.subscribe(function(a){if(a)for(var c=0;c<this.imageViewerApis().length;c++)this.initImageViewer(c)}.bind(this)),this.onImageViewerApiReady=function(a){var d=c.data.rootElement.querySelector('[data-gallery-index="'+a+'"]');this.imageData()&&this.initImageViewer(a,d)},this.getImageIndexFromGalleryIndex=function(c){var d=1===c?this.colourOptionImage():this.galleryItems()[c],ee=a.utils.arrayFirst(ce,(function(a){return a.url===d.url}));return ce.indexOf(ee)},this.setImageViewers=function(){for(var c,d=this.galleryItems(),ee=[],te=0;te<ce.length;te++)ee.push(ce[te].url);for(te=0;te<d.length;te++)c=a.observable(),this.imageViewerApis.push(c),this.imageViewersVisibility.push(!1),c.subscribe(this.onImageViewerApiReady.bind(this,te));this.loadImagesMetadata(ee)},this.resetImageViewer=function(){var a=this.imageViewerApis()[this.galleryIndex()]&&this.imageViewerApis()[this.galleryIndex()]();a&&a.zoomReset()},this.setSwipe=function(){if(window.addEventListener){var a=document.querySelector(".product-gallery .window"),c=new te(a,{inputClass:te.TouchInput});c.on("swipeleft",function(){this.moveRight()}.bind(this)),c.on("swiperight",function(){this.moveLeft()}.bind(this))}},this.showSellingFastLabel=a.computed(function(){var a=!this.isVideoVisible()&&!this.isSpinViewerVisible();return this.isInStock()&&c.state.sellingFast&&a}.bind(this)),this.galleryText={thumbnailLabel:d.resources.pdp_media_gallery_thumbnail_label,carouselLabel:d.resources.pdp_media_gallery_carousel_label},this.showInteractiveButtons=a.computed(function(){return!!this.isInStock&&(this.isVideoButtonVisible()||this.isSpinViewerButtonVisible())}.bind(this)),this.init(),ae.asos.eventBus.emit("GalleryInitialised")},template:d}})),define("ProductUtils/ScrollTo",["$","ko"],(function(a,c){return this.scrollToElement=function(c,d){var ee=a(c);ee.length>0&&a("html, body").animate({scrollTop:ee.offset().top+d+"px"},"fast")},this.scrollToTop=function(){a("html, body").animate({scrollTop:"0px"},"fast")},c.bindingHandlers.scrollTo={init:function(d,ee){var te=ee(),ie=c.unwrap(te),ne=ie,se=0;"object"==typeof ie&&(ne=ie.selector,ie.topPadding&&(se=ie.topPadding)),a(d).click(function(){this.scrollToElement(ne,se)}.bind(this))}},c.bindingHandlers.scrollToTop={init:function(c){a(c).click(function(){this.scrollToTop()}.bind(this))}},this})),define("ProductUtils/Performance",["ko"],(function(a){a.bindingHandlers.markAndMeasure={init:function(c,d){var ee=a.unwrap(d());window.asos.performance.markAndMeasure(ee)}}})),define("Pages/FullProduct",["ko","ProductUtils/ComponentLoader","Asos.Utils.MediaPlayers","ProductUtils/StockPrice","Models/VariantDecorator","Components/product-image/product-image","Components/content/content","Components/product-gallery/product-gallery","PageConfig","ProductUtils/NewRelicLogger","Components/product-gallery/product-gallery","ProductUtils/ScrollTo","ProductUtils/Performance"],(function(a,c,d,ee,te,ie,ne,se,re,oe){return this.init=function(){oe.init(oe.PAGE_TYPE.PRD);var ee=window.asos.pdp.config.product,te=window.asos.pdp.config.translations,ne=window.asos.pdp.config.ratings,ae=window.asos.pdp.config.product.saveCount,ce="string"==typeof ee?JSON.parse(ee):ee,le=new c;this.isMobile="mobile"===re.platform,ce||oe.logError(new Error(oe.ERROR_TYPE.ParseError),{action:"PageInit",message:"server-side product data missing or invalid"}),this.state={resources:te,features:window.asos.pdp.config.features,gender:ce.gender,sellingFast:ce.sellingFast,ratings:ne,saveCount:ae,hasVariantsWithIngredients:ce.hasVariantsWithIngredients};var de=!1;function registerComponents(){de||(le.register({type:"content",name:"content3",elementId:"gallery-content",useComponentTemplate:!1},ce,this.state),a.components.register("product-gallery",se),a.components.register("product-image",ie),a.components.register("asos-video-player-prod",d.videoPlayer),a.components.register("asos-spin-viewer-prod",d.spinViewer),de=!0)}document.addEventListener("DOMContentLoaded",function(){registerComponents.call(this)}.bind(this)),document.getElementById("gallery-content")&&registerComponents.call(this)},this.init})),window.location.href.includes("/prd/")&&require(["Pages/FullProduct"],(function(a){a()})),define("text!Components/product-price/product-price.html",[],(function(){return'<div class="grid-row rendered price-container" data-testid="product-price">\n  <span class="sr-in-doc-flow" aria-live="polite" data-bind="text: getAriaLabel()"></span>\n  <div>\n    <div class="current-price">\n      <span aria-hidden="true" data-testid="current-price" data-bind="text: priceText, markAndMeasure: \'pdp:price_displayed\', css: { discounted: isDiscountedPrice }" class="current-price-text"></span>\n      \x3c!-- ko if: showGermanVatMessage --\x3e\n      <span aria-hidden="true" data-testid="german-vat-message" data-bind="text: i18n.pdp_misc_vat_message" class="product-german-vat"></span>\n      \x3c!-- /ko --\x3e\n    </div>\n    <div>\n      \x3c!-- ko if: showLowestPrice30Days() --\x3e\n      <span aria-hidden="true" data-bind="text: lowestPrice30DaysText" class="previous-price-text"></span>\n      <span aria-hidden="true" data-bind="text: lowestPrice30DaysPercentage, css: { discounted: lowestPrice30DaysPercentageHighlight }" class="previous-price-text"></span>\n      \x3c!-- /ko --\x3e\n    </div>\n    <div>\n      \x3c!-- ko if: showRrpPrice() --\x3e\n      <span aria-hidden="true" data-bind="text: rrpPriceText" class="previous-price-text"></span>\n      \x3c!-- /ko --\x3e\n      \x3c!-- ko if: showPrevPrice() --\x3e\n      <span aria-hidden="true" data-bind="text: prevPriceText" class="previous-price-text"></span>\n      \x3c!-- /ko --\x3e\n      \x3c!-- ko if: isDiscountedPrice --\x3e\n      <span aria-hidden="true" data-bind="text: \'(\' + discountText() + \')\', visible: !!discountText()" class="price-discount-percent"></span>\n      \x3c!-- /ko --\x3e\n      \x3c!-- ko if: showPricingInformationTooltip() --\x3e\n      <button class="pricingButton" aria-label="More Pricing Information" data-bind="click: openPricingInfo">\n        <span class="product-information-light"></span>\n      </button>\n      \x3c!-- /ko --\x3e\n    </div>\n  </div>\n</div>'})),define("ProductUtils/Discount",["ko","Providers/FeaturesProvider","ProductUtils/calculateDiscount"],(function(a,c,d){var ee=a.observable(!1),te=[];function getDiscount(a,c){return"-"+d(a,c)+"%"}return c.onReady().then((function(){ee(c.getFeature("all-show-discount-label").isEnabled())})),ee.subscribe((function(a){a&&te.forEach((function(a){a.observable(getDiscount(a.currentPrice,a.previousPrice))}))})),{getDiscountText:function getDiscountText(a,c,d){if(!ee())return te.push({observable:a,currentPrice:c,previousPrice:d}),a("");a(getDiscount(c,d))}}})),define("Components/product-price/product-price",["ko","text!./product-price.html","ProductUtils/Discount","PageConfig","ProductUtils/Window"],(function(a,c,d,ee,te){function notNullOrUndefined(a){return null!=a}return{viewModel:function ViewModel(c){var ie=["AD","AL","AM","AT","AX","AZ","BA","BE","BG","BL","CY","CZ","DE","DK","EE","ES","FI","FO","FR","GE","GF","GL","GP","GR","HR","HU","IE","IT","KG","KZ","LT","LU","LV","MC","MD","ME","MF","MK","MQ","MT","NC","NL","NO","PF","PL","PM","PT","RE","RO","RS","SE","SI","SJ","SK","SM","TF","TR","VA","WF","YT"].indexOf(ee.countryCode)>-1,ne=function(){return ie?this.showRrpPrice()?"eu_omnibus_outlet":"eu_omnibus_non_outlet":this.showRrpPrice()?"rrp":"was"}.bind(this);this.openPricingInfo=function(a,c){var d="SPAN"==c.target.tagName?c.target.parentElement:c.target,ie=te.asos.siteChrome.modals.openIFrameModal,se={consumer:"pdp",url:"web/pages/simple-modal/index.html?contentTemplate="+ne()+"_pricing_info&lang="+ee.language,focusOnCloseElement:d,modalType:te.asos.siteChrome.modals.modalTypes.SIDE_RIGHT};if(ie)return ie(se)};var se=c.state,re=se.productData;this.i18n=se.resources,this.showGermanVatMessage=!!c.showGermanVatMessage;var oe=a.observable(re.price);this.showLowestPrice30Days=a.computed((function(){return!(!ie||!oe())&&(notNullOrUndefined(oe().lowestPriceInLast30DaysText)&&notNullOrUndefined(oe().lowestPriceInLast30DaysValue))})),this.lowestPrice30DaysText=a.computed(function(){return this.showLowestPrice30Days()?this.i18n.lowest_price_last_thirty_days+" "+oe().lowestPriceInLast30DaysText:""}.bind(this)),this.lowestPrice30DaysPercentage=a.computed(function(){return this.showLowestPrice30Days()?function buildLowestPricePercentage(a){if(isNaN(a))return"";var c=-a;return"("+(c>0?"+":"")+c+"%)"}(oe().lowestPriceInLast30DaysPercentage):""}.bind(this)),this.lowestPrice30DaysPercentageHighlight=a.computed(function(){if(this.showLowestPrice30Days())return oe().lowestPriceInLast30DaysPercentage>0}.bind(this)),this.showRrpPrice=a.computed((function(){return!!oe()&&oe().isOutletPrice})),this.rrpPrice=a.computed(function(){if(this.showRrpPrice())return oe().rrp}.bind(this)),this.rrpPriceText=a.computed(function(){if(!this.rrpPrice())return"";var a=this.rrpPrice().text;return a?this.i18n.pdp_price_rrp+" "+a:""}.bind(this)),this.showPrevPrice=a.computed(function(){return!!oe()&&(oe().isMarkedDown&&!oe().isOutletPrice)}.bind(this)),this.prevPrice=a.computed(function(){if(this.showPrevPrice())return oe().previous}.bind(this)),this.prevPriceText=a.computed(function(){return this.showPrevPrice()?this.i18n.was_pricing_label_pdp+" "+this.prevPrice().text:""}.bind(this)),this.showFromLabel=a.computed((function(){return!(!re.hasDifferentPrices||se.selectedSize()&&se.selectedColour())})),this.price=a.computed((function(){return oe()?oe().current:void 0})),this.priceText=a.computed(function(){if(void 0===this.price())return"";var a="";return(this.showPrevPrice()||this.showRrpPrice())&&(a=this.i18n.now_pricing_label+" "),this.showFromLabel()&&(a=this.i18n.pdp_misc_from+" "),a+this.price().text}.bind(this)),this.isDiscountedPrice=a.computed(function(){return this.showPrevPrice()||this.showRrpPrice()}.bind(this)),this.showPricingInformationTooltip=a.computed(function(){return ie&&this.isDiscountedPrice()}.bind(this)),this.discountText=a.observable("");var ae=function(){this.showRrpPrice()&&this.rrpPrice()?d.getDiscountText(this.discountText,this.price().value,this.rrpPrice().value):this.showPrevPrice()&&this.prevPrice()&&d.getDiscountText(this.discountText,this.price().value,this.prevPrice().value)}.bind(this);this.getAriaLabel=a.computed(function(){var a=this.priceText();return this.showGermanVatMessage&&(a=a.concat(" ",this.i18n.pdp_misc_vat_message_longform||this.i18n.pdp_misc_vat_message)),this.showLowestPrice30Days()&&(a=a.concat(". "+this.lowestPrice30DaysText()+" "+this.lowestPrice30DaysPercentage())),this.showPrevPrice()&&(a=a.concat(". "+this.prevPriceText())),this.showRrpPrice()&&(a=a.concat(". "+(this.i18n.pdp_price_rrp_longform||this.i18n.pdp_price_rrp)," ",this.rrpPrice().text)),this.isDiscountedPrice()&&this.discountText()&&(a=a.concat(". ("+this.discountText()+")")),a}.bind(this)),se.selectedSize.subscribe(function(a){oe(a?a.price:re.price),ae()}.bind(this)),ae()},template:c}})),define("text!Components/add-item/add-item.html",[],(function(){return'<div class="add-item" data-bind="visible: isVisible">\n    <div class="is-add-item-saving" data-bind="visible: isBusy"></div>\n    <span class="aria-live" role="status" aria-live="polite" data-bind="{ text: ariaLiveText }" data-testid="ariaLiveRegion"></span>\n    <button data-bind="click: addToBag, css : buttonCss, attr: { \'id\': isMixMatch ? null : \'product-add-button\', \'aria-label\': resources.pdp_cta_add_to_bag, disabled: isBusy }, markAndMeasure: \'pdp:add_to_bag_interactive\'" data-testid="add-button">\n        <span class="product-tick" data-bind="visible: showProductTick"></span>\n        <span data-bind="text: buttonText"></span>\n    </button>\n</div>\n'})),define("ProductUtils/Analytics/Utils/GetProductBeaconsMapFromStorage",[],(function(){return function(){var a;try{a=JSON.parse(sessionStorage.getItem("productBeaconsMap"))||{}}catch(c){a={}}return a}})),define("ProductUtils/Analytics/Utils/SponsoredAdsBeacons",["ProductUtils/Analytics/Utils/GetProductBeaconsMapFromStorage"],(function(a){return{sendBeacon:function sendBeacon(c,d){var ee=a(),te=ee[c];if(te){var ie=te[d];ie&&(navigator.sendBeacon(ie),delete te[d],0===Object.keys(te).length&&delete ee[c],sessionStorage.setItem("productBeaconsMap",JSON.stringify(ee)))}}}})),define("ProductUtils/Bag",["ProductUtils/Analytics","ProductUtils/NewRelicLogger","Providers/SdkProvider","ProductUtils/Analytics/Utils/SponsoredAdsBeacons"],(function(a,c,d,ee){return function(te,ie){function addToObject(a,c){for(var d in c)c.hasOwnProperty(d)&&(a[d]=c[d]);return a}function createBagVariant(a){return{productId:a.productId,colour:a.colourName,sizeId:a.sizeId,variantId:a.variantId,price:a.price.current.value,priceObj:a.price,sellingFast:te.state.sellingFast,ratings:!!a.ratings,sizeGuideOpened:te.state.sizeGuideOpened,brandName:a.brandName,source:a.source,seller:a.seller,sku:a.sku}}return this.error="",void 0!==te&&(this.error=te.state.resources.pdp_status_error_max_items),this.addItems=function(a,c){d.getBag().then(function(d){var ee;if(a.length>1){var te=this.formatAddProducts(a);ee=d.addVariants(te),this.watchPromise(ee,c,te,ie)}else{var ne=void 0!==a[0]?a[0]:a;ne.colourName=void 0===ne.colourName?ne.colour:ne.colourName;var se=createBagVariant(ne);ee=d.addVariant(se),this.watchPromise(ee,c,se,ie)}}.bind(this))},this.formatErrorMessage=function(a){var c=a.userMessage||"";return a.hasOwnProperty("messageContext")&&a.messageContext&&a.messageContext.length>0&&(c=c.replace(/{(\d)}/g,(function(c,d){var ee=a.messageContext[parseInt(d,10)];return ee||"..."}))),c},this.watchPromise=function(d,ie,ne,se){d.then((function(){a.addVariants(ne,!1,se,te.state.ratings,te.state.saveCount);var c=void 0!==ne[0]?ne[0]:ne;return ee.sendBeacon(c.productId,"onBasketChangeBeacon"),ie({success:!0,error:""})}),function(d){d=a.normalizeError(d,te.state.resources.pdp_status_add_to_bag_failure),a.addVariants(ne,d,se,te.state.ratings,te.state.saveCount);var ee,re={action:"AddToBag"};re=addToObject(re,ne),re=addToObject(re,d),re=addToObject(re,d.message[0]),c.logError(new Error(c.ERROR_TYPE.UserActionFailed),re),ee="LegacyQuantityLimitReached"===d.message[0].errorCode?this.error:this.formatErrorMessage(d.message[0]),ie({success:!1,error:ee})}.bind(this))},this.formatAddProducts=function(a){for(var c=[],d=0;d<a.length;d++){var ee=createBagVariant(a[d]);ee.colourName=void 0===ee.colourName?ee.colour:ee.colourName,c.push(ee)}return c},this}})),define("Components/add-item/add-item",["$","ko","text!./add-item.html","ProductUtils/Bag","ProductUtils/ScrollTo","ProductUtils/Window","PageConfig"],(function(a,c,d,ee,te,ie,ne){return{viewModel:function ViewModel(a){this.isVisible=a.state.productData.isInStock,this.imgUrl=a.productImage,this.scrollToTop=a.scrollToTop,this.url=a.url,this.productId=a.state.productData.productId,this.isMixMatch=a.isMixMatch,this.resources=a.state.resources,this.selectedColour=a.state.selectedColour,this.selectedSize=a.state.selectedSize,this.noColourSelected=a.state.showNoColourSelectedWarning,this.noSizeSelected=a.state.showNoSizeSelectedWarning,this.focusColourSelect=a.state.focusColourSelect,this.focusSizeSelect=a.state.focusSizeSelect,this.preventFocusScroll=a.state.preventFocusScroll,this.addedToBag=c.observable(!1),this.showProductTick=c.observable(!1),this.failedToAdd=a.state.showAddToBagError,this.failedToAddMessage=a.state.addToBagErrorMessage,this.showTryAgain=c.observable(!!a.showTryAgain&&a.showTryAgain),this.buttonText=c.observable(this.resources.pdp_cta_add_to_bag),this.isBusy=c.observable(!1),this.ariaLiveText=c.computed((function(){var a=this.failedToAddMessage();return a||(this.addedToBag()?this.resources.pdp_status_add_to_bag_success:"")}),this),this.buttonCss=c.computed(function(){return this.failedToAdd()&&this.showTryAgain()?"failed":""}.bind(this)),this.selectedSize.subscribe(function(a){this.failedToAdd(!1),void 0!==a&&this.noSizeSelected()&&this.noSizeSelected(!1)}.bind(this)),this.selectedColour.subscribe(function(a){this.failedToAdd(!1),void 0!==a&&this.noColourSelected()&&this.noColourSelected(!1)}.bind(this));var d,ie=new ee(a,a.initiator);this.isValid=function(){return void 0===this.selectedColour()?(this.noColourSelected(!0),!1):void 0!==this.selectedSize()||(this.noSizeSelected(!0),!1)}.bind(this),this.addToBag=function(){this.isBusy()||(this.revertState(),this.isValid()&&(this.isBusy(!0),ie.addItems(this.selectedSize(),this.addToBagResult)))},this.focusUnSelected=function(){void 0===this.selectedColour()?this.focusColourSelect(!0):void 0===this.selectedSize()&&this.focusSizeSelect(!0)}.bind(this),this.addToBagResult=function(a){this.isBusy(!1),a.success?(this.addedToBag(!0),this.showProductTick(!0),this.buttonText(this.resources.pdp_status_add_to_bag_success),this.scrollToTop&&"mobile"!==ne.platform&&te.scrollToTop(),d&&clearTimeout(d),d=setTimeout(this.revertState,5e3)):(this.showTryAgain()&&this.buttonText(this.resources.pdp_status_error_add_item_try_again),this.failedToAdd(!0),this.failedToAddMessage(a.error||this.resources.pdp_status_add_to_bag_failure))}.bind(this),this.revertState=function(){this.buttonText(this.resources.pdp_cta_add_to_bag),this.addedToBag(!1),this.showProductTick(!1),this.failedToAdd(!1),this.failedToAddMessage(""),this.isBusy(!1)}.bind(this)},template:d}})),define("text!Components/size-guide/size-guide.html",[],(function(){return'\x3c!-- ko if: render() --\x3e\n<div class="size-guide-button">\n    <button data-testid="size-guide-button" class="link" data-bind="click: openSizeGuide($element), text: text"></button>\n</div>\n\x3c!-- /ko --\x3e\n'})),define("Components/size-guide/size-guide",["ko","text!./size-guide.html","ProductUtils/Window","ProductUtils/Analytics"],(function(a,c,d,ee){return{viewModel:function ViewModel(a){this.text=a.dictionary.pdp_size_guide_link,this.render=a.visible,this.openSizeGuide=function(c){return function(){!function fireSizeGuideEvent(){ee.firePageInteraction({context:"launchSizeGuide",productIID:a.id})}(),d.asos.eventBus.emit("sizeGuideOpen",{url:a.url,focusOnClose:c})}}},template:c}})),define("text!Components/mix-and-match/mix-and-match.html",[],(function(){return'<div class="product-hero">\n  <div class="separator"></div>\n</div>\n\n<ul>\n  \x3c!-- ko foreach: products --\x3e\n  <li class="item">\n    <a data-bind="attr: { \n          href: $parent.getProductLink($data), \n          \'aria-label\': $parent.productDetailsText \n    }, \n    click: $parent.navigateToFullProduct.bind($data, $index()), $element\n    ">\n      <div class="product-image" data-bind="component: {\n        name: \'product-image\', \n        params: {\n          imgUrl: productImage.url,\n          type: \'thumbnail\',\n          size: 75\n        }\n      }">\n      </div>\n    </a>\n    <div class="product-info">\n      \x3c!--Product title--\x3e\n      <a\n        data-bind="attr: { href: $parent.getProductLink($data) }, click: $parent.navigateToFullProduct.bind($data, $index())" class="product-title-link">\n        <div class="product-title" data-bind="text: name"></div>\n      </a>\n      <div class="product-price"\n        data-bind=\'component: { name: "product-price", params: {state: $parent.getState($index()), showGermanVatMessage: $parent.options.showGermanVatMessage }}\'>\n      </div>\n      <div class="mm-rating" data-bind="attr: {id: \'overall-rating-portal-\' + $data.id}"></div>      \n      <div data-bind="attr: {id: \'payment-promo-portal-\' + $data.id}"></div>\n      \x3c!-- ko if: $parent.variantIsOOS($index()) --\x3e\n      <span class="out-of-stock" data-bind="text: $parent.state.resources.pdp_status_mix_and_match_out_of_stock"></span>\n      \x3c!-- /ko --\x3e\n      \x3c!-- ko if: !$parent.variantIsOOS($index()) --\x3e\n      <div class="product-colour" data-bind=\'component:{\n        name: "product-colour",\n        params: {\n            isMixAndMatch: true,\n            useShortSelectColourLabel: true,state: $parent.getState($index()),\n            data: $data}\n        }\'></div>\n      \x3c!-- /ko --\x3e\n    </div>\n    \x3c!-- ko if: $parent.variantIsOOS($index()) --\x3e\n    <div class="save-for-later-portal oos" data-bind="attr: {id: \'save-for-later-portal-\' + $data.id}"></div>\n    \x3c!-- /ko --\x3e\n    \x3c!-- ko if: !$parent.variantIsOOS($index()) --\x3e\n    <div data-bind=\'component:{\n      name: "product-size",\n      params: {\n          hideLabels: false,\n          hideLowInStock: false,\n          hideOnOutOfStock: true,\n          showSizeGuide: true,\n          isMixMatch: true,\n          isMobile: $parent.isMobile,\n          doNotSelectDefaultSize: !$parent.isMobile,\n          displayOnlyAsDropDown: !$parent.isMobile,\n          state: $parent.getState($index()),\n          data: $data,\n          context: "mixmatch",\n          selectorIndex: $index(),\n          sizeGuideOpened: $parent.state.sizeGuideOpened\n          }\n      }\'>\n    </div>\n\n    <div data-bind=\'component:{name: "add-item",\n      params:{\n          state: $parent.getState($index()),\n          initiator : "main",\n          isMixMatch: true,\n      }}\'></div>\n    <div class="save-for-later-portal" data-bind="attr: {id: \'save-for-later-portal-\' + $data.id}"></div>\n    \n    <div class="basic-error-box"\n      data-bind="visible: $parent.getState($index()).showAddToBagError, html: $parent.getState($index()).addToBagErrorMessage"\n      style="display: none"></div>\n    \x3c!-- /ko --\x3e\n    <div data-bind="attr: {id: \'delivery-and-returns-portal-\' + ($index())}, template: { afterRender: function() {\n      if($index() === $parent.products.length - 1) {\n          window.asos.pdp.deliveryAndReturnsPortalReady = true; window.asos.eventBus.emit(\'deliveryAndReturnsPortalReady\');\n      }\n    }}" style="float: left; width: 100%">\n    </div>\n    \x3c!-- ko if: ($index() !== $parent.products.length - 1)--\x3e\n    <div class="separator"></div>\n    \x3c!-- /ko --\x3e\n  </li>\n  \x3c!-- /ko --\x3e\n</ul>'})),define("Components/mix-and-match/mix-and-match",["ko","text!./mix-and-match.html","ProductUtils/Analytics","ProductUtils/UrlUtils","ProductUtils/Window","PageConfig"],(function(a,c,d,ee,te,ie){return{viewModel:function ViewModel(a){this.context=a.data,this.products=a.data.products,this.state=a.state,this.options=a.options,this.isMobile="mobile"===ie.platform,this.showNoSizesSelectedWarning=a.state.showNoSizesSelectedWarning,this.showAddToBagError=a.state.showAddToBagError,this.addToBagErrorMessage=this.state.addToBagErrorMessage,this.variants=[],this.productDetailsText=this.state.resources.pdp_description_product_details_title;for(var c=new ee,ne=this.products.length;ne--;)this.variants.push(this.context.States[ne].selectedSize);this.getState=function(a){return this.context.States[a]}.bind(this),this.variantIsOOS=function(a){return!this.getState(a).productData.isInStock}.bind(this),this.showOverlay=function(a,c){d.firePageInteraction({context:"openModal",modalType:"mixAndMatch",productIID:this.products[a].id}),te.asos.eventBus.emit("productModalOpen",c,this.products[a].id)}.bind(this),this.getProductLink=function(a){return c.getProductUrl(a.name,this.context.brandName,a.id)+this.getQueryString()}.bind(this),this.navigateToFullProduct=function(a){var c=this.getProductLink(this.products[a]);this.navigateTo(c)}.bind(this),this.navigateTo=function(a){window.location=a},this.getQueryString=function(){return document.location.search}},template:c}})),define("text!Components/product-colour/product-colour.html",[],(function(){return'\x3c!-- ko if: render && (colourDropdownVisible() || isMixAndMatch) --\x3e\n<section>\n    <div class="colour-size colour-component">\n        <div class="grid-row colour-section">\n            <label for="colourSelect" class="disabled" data-bind="\n                text: colourLabel,\n                attr: {\n                    \'for\': colourSelectorId\n                }\n            "></label>\n            \x3c!-- ko if: isMixAndMatch --\x3e\n                <span class="product-colour" data-bind="visible: colourLabelVisible(), text: selectedColourLabel(), css: { disabled: isDisabled }"></span>\n            \x3c!-- /ko --\x3e\n            <div class="colour-size-select" data-testid="colour-size-select" data-bind="visible: colourDropdownVisible()">\n                <select id="colourSelect"\n                        data-id="colourSelect"\n                        data-bind="optionsCaption: selectColourText,\n                        disable: isDisabled,\n                        options: data,\n                        optionsAfterRender: setColourOptionText,\n                        value: colour,\n                        css:{ required : noColourSelected()},\n                        attr: {\n                            \'id\': colourSelectorId,\n                            \'data-id\': colourSelectorId,\n                            \'aria-describedby\': noColourSelected() ? \'selectColourError\' : null,\n                            \'aria-invalid\': noColourSelected() ? true : null\n                        }"></select>\n                \x3c!-- ko if: noColourSelected() --\x3e\n                <span id="selectColourError" class="error basic-error-box" data-bind="text:selectColourPrompt"></span>\n                \x3c!-- /ko --\x3e\n            </div>\n        </div>\n    </div>\n</section>\n\x3c!-- /ko --\x3e'})),define("Components/product-colour/product-colour",["ko","text!./product-colour.html","PageConfig","ProductUtils/Window"],(function(a,c,d,ee){return{viewModel:function ViewModel(c){var te=c.state,ie="undefined"!==c.hideOnOutOfStock&&c.hideOnOutOfStock;this.render=!(ie&&!te.productData.isInStock),this.noColourSelected=c.state.showNoColourSelectedWarning,this.focusColourSelect=c.state.focusColourSelect,this.preventFocusScroll=c.state.preventFocusScroll,this.isMixAndMatch=c.isMixAndMatch,this.data=a.observableArray(),this.colour=te.selectedColour,this.colour.subscribe((function(a){ee.asos.eventBus.emit("colourChosen",a&&a.colour)})),this.useShortSelectColourLabel=c.useShortSelectColourLabel,this.selectColourPrompt=te.resources.pdp_select_colour_message,this.colourLabel=te.resources.pdp_misc_colour+":",this.isMobile="mobile"===d.platform,this.notAvailableText=te.resources.pdp_status_not_available,this.selectorIndex=c.selectorIndex,this.context=c.context,this.colourSelectorId="colour-select-"+te.productData.productId,this.useShortSelectColourLabel?this.selectColourText=te.resources.pdp_select_colour_label:this.selectColourText=te.resources.pdp_select_colour_from_label,this.lowInStockText=te.resources.pdp_status_low_in_stock;var ne=c.state.productData;this.isDisabled=!c.state.productData.isInStock;var se=ne.colours;this.focusColourSelect.subscribe(function(a){a&&(document.getElementById(this.colourSelectorId).focus({preventScroll:!!this.preventFocusScroll()}),this.preventFocusScroll(!1),this.focusColourSelect(!1))}.bind(this)),this.noColourSelected.subscribe(function(a){a&&this.focusColourSelect(!0)}.bind(this)),this.data(se),this.selectColourText=this.selectColourText.replace("%{count}",this.data().length),this.colourDropdownVisible=a.computed(function(){return this.data().length>1}.bind(this)),this.colourLabelVisible=a.computed(function(){return!this.colourDropdownVisible()}.bind(this)),this.setColourOptionText=function(a,c){c&&(ne.hasDifferentPrices?a.text=c.colour+" "+c.price.text:a.text=c.colour)},this.selectedColourLabel=a.computed(function(){return this.colour()?this.colour().colour:""}.bind(this)),this.setDefaultColour=function setDefaultColourAndSize(){1===this.data().length&&this.colour(this.data()[0])},this.setDefaultColour(),this.setVariantColour=function(a,c){for(var d=0;d<a.length;d++)if(a[d].colourWayId===c){this.colour(a[d]);break}},c.state.defaultVariant&&this.setVariantColour(this.data(),c.state.defaultVariant.colourWayId)},template:c}})),define("text!Components/product-size/product-size.html",[],(function(){return'\x3c!-- ko if: render() --\x3e\n<section>\n    <div class="colour-size size-component">\n        <div class="size-section" data-bind="visible: sizeSectionVisible()">\n            <div style="display: table; width: 100%">\n                <label\n                    for="sizeSelectorId"\n                    style="display: table-cell; vertical-align: bottom"\n                    data-bind="\n                        text: sizeLabel,\n                        visible: sizeDropdownVisible(),\n                        disable: isDisabled,\n                        attr: {\n                            \'for\': sizeSelectorId\n                        }"\n                ></label>\n                <div style="display: table-cell; vertical-align: top; width: 100%">\n                    <div data-testid="size-guide" class="size-guide" style="float: right;" data-bind=\'component: { name: "size-guide", params: { sizeGuideOpened: sizeGuideOpened, dictionary: sizeGuideDictionary , url: sizeGuideLink, visible: state.showSizeGuide, id:id}}\'></div>\n                </div>\n            </div>\n            \x3c!-- ko if: !isOneSize --\x3e\n            <span class="product-size" data-bind="visible: sizeLabelVisible(), text: selectedSizeLabel(), css: { disabled: isDisabled }"></span>\n            \x3c!-- /ko --\x3e\n            <div class="colour-size-select" data-testid="colour-size-select" data-bind="visible: sizeDropdownVisible(), markAndMeasure: \'pdp:size_selector_interactive\'">\n                <select\n                    id="sizeSelectorId"\n                    data-id="sizeSelect"\n                    data-bind="options: variants,\n                        optionsAfterRender: disableSizeIfOutOfStock,\n                        optionsText: \'Size\',\n                        optionsCaption: selectSizeText,\n                        value: size,\n                        disable: isDisabled || sizeDropdownDisabled(),\n                        css:{ required : noSizeSelected() },\n                        attr: {\n                            \'id\': sizeSelectorId,\n                            \'aria-label\': selectSizeText,\n                            \'aria-describedby\': noSizeSelected() ? \'selectSizeError\' : null,\n                            \'aria-invalid\': noSizeSelected()\n                        }"></select>\n                \x3c!-- ko if: noSizeSelected() --\x3e\n                <span id="selectSizeError" class="error basic-error-box" data-bind="text:selectSizePrompt"></span>\n                \x3c!-- /ko --\x3e\n            </div>\n        </div>\n        <div class="grid-row low-in-stock" data-testid="lowInStock" data-bind="visible: isLowInStock() && !hideLowInStock">\n            <span class="clock"></span><span data-bind="text:lowInStockText"></span>\n        </div>\n    </div>\n</section>\n\x3c!-- /ko --\x3e\n'})),define("Components/product-size/product-size",["ko","text!./product-size.html","ProductUtils/Analytics","ProductUtils/Window"],(function(a,c,d,ee){return{viewModel:function ViewModel(c){var te=c.data,ie=c.state,ne="undefined"!==c.hideOnOutOfStock&&c.hideOnOutOfStock;this.state=ie,this.noSizeSelected=c.state.showNoSizeSelectedWarning,this.focusSizeSelect=c.state.focusSizeSelect,this.preventFocusScroll=c.state.preventFocusScroll,this.sizeGuideOpened=c.isMixMatch?c.sizeGuideOpened:c.state.sizeGuideOpened,this.sizeGuideDictionary=c.state.resources,this.sizeGuideLink=te.sizeGuide,this.colour=ie.selectedColour,this.size=ie.selectedSize,this.alwaysDisplaySizeLabel=!1,this.isLowInStock=a.observable(!1),this.hideLabels=c.hideLabels,this.hideLowInStock=c.hideLowInStock,this.displayOnlyAsDropDown=c.displayOnlyAsDropDown||!1,this.doNotSelectDefaultSize=c.doNotSelectDefaultSize||this.displayOnlyAsDropDown,this.id=te.id,this.isOneSize=te.isOneSize;var se=[];this.size.subscribe(function(){var a=this.size(),te=null!=a&&!0===a.isLowInStock;a&&-1===se.indexOf(a)&&(d.fireFlexFulfilmentAnalyticsEvent(a),se.push(a));var ie=c.isMixMatch?c.selectorIndex:null,ne={variantId:null,productId:this.id,mixAndMatchProductIndex:ie};a&&(ne={variantId:a.variantId,productId:a.productId,mixAndMatchProductIndex:ie,source:a.source,seller:a.seller}),ee.asos.eventBus.emit("sizeChanged",ne),this.isLowInStock(te)}.bind(this)),this.isDesktopMixMatch=c.isMixMatch&&!c.isMobile,this.selectorIndex=c.selectorIndex,this.context=c.context,this.sizeSelectorId=this.context+"-size-select-"+this.selectorIndex,this.variants=a.computed(function(){return void 0===this.colour()?[]:this.colour().variants}.bind(this)),ie.showSizeGuide||(ie.showSizeGuide=a.observable(!1)),ie.showSizeGuide(!0===c.showSizeGuide&&te.sizeGuideVisible),this.selectSizePrompt=ie.resources.pdp_select_colour_size_message,this.sizeLabel=ie.resources.pdp_misc_size+":",this.outOfStockText=ie.resources.pdp_status_out_of_stock,this.notAvailableText=ie.resources.pdp_status_not_available,this.selectSizeText=ie.resources.pdp_select_size_label,this.lowInStockText=ie.resources.pdp_status_low_in_stock;var re=c.state.productData;this.isDisabled=!c.state.productData.isInStock;for(var oe=re.colours,ae=0,ce=oe.length-1;ce>=0;ce--){var le=oe[ce];le.variants.length>ae&&(ae=le.variants.length)}this.focusSizeSelect.subscribe(function(a){var c=document.getElementById(this.sizeSelectorId);a&&(c.focus({preventScroll:!!this.preventFocusScroll()}),this.preventFocusScroll(!1),this.focusSizeSelect(!1))}.bind(this)),this.noSizeSelected.subscribe(function(a){this.focusSizeSelect(a)}.bind(this)),!this.displayOnlyAsDropDown&&!te.isNoSize&&oe.length>1&&1===ae&&(this.alwaysDisplaySizeLabel=!0),this.colour.subscribe(function(a){void 0===a||1!==this.colour().variants.length||this.displayOnlyAsDropDown?this.setDefaultSize():this.size(this.colour().variants[0])}.bind(this)),this.sizeDropdownVisible=a.computed(function(){if(this.alwaysDisplaySizeLabel)return!1;if(this.displayOnlyAsDropDown)return!0;if(te.isNoSize)return!1;var a=void 0===this.colour(),c=a?0:this.colour().variants.length;return a||c>1}.bind(this)),this.sizeLabelVisible=a.computed(function(){return!!this.alwaysDisplaySizeLabel||!this.displayOnlyAsDropDown&&!te.isNoSize&&!this.sizeDropdownVisible()}.bind(this)),this.sizeSectionVisible=a.computed(function(){return this.sizeLabelVisible()||this.sizeDropdownVisible()}.bind(this)),this.render=a.computed(function(){return!(ne&&!ie.productData.isInStock)&&(!te.isOneSize&&this.variants()&&this.variants().length>1)}.bind(this)),this.disableSizeIfOutOfStock=function(c,d){var ee;null!=d&&(ee=re.hasDifferentPrices&&void 0!==d.price&&void 0!==d.price.current?" - "+d.price.current.text:"",d.isInStock||(ee+=" - "+this.outOfStockText),c.text=d.size+ee,a.applyBindingsToNode(c,{enable:d.isInStock},d))}.bind(this),this.sizeDropdownDisabled=a.computed(function(){return void 0===this.colour()}.bind(this)),this.selectedSizeLabel=a.computed(function(){return this.alwaysDisplaySizeLabel?oe[0].variants[0].size:this.size()?this.size().size:""}.bind(this)),this.setDefaultSize=function setDefaultSize(){if(!this.doNotSelectDefaultSize&&void 0!==re&&void 0!==this.variants()&&1===re.colours.length){for(var a,c=re.colours[0],d=c.variants.length-1;d>=0;d--)if(c.variants[d].isInStock){if(void 0!==a){a=void 0;break}a=this.variants()[d]}void 0!==a&&this.size(a)}},this.setVariantSize=function(a,c){for(var d=0;d<a.length;d++)if(a[d].variantId===c){if(!a[d].isInStock){this.size(void 0);break}this.size(a[d]);break}},this.setDefaultSize(),c.state.defaultVariant&&this.setVariantSize(this.variants(),c.state.defaultVariant.variantId)},template:c}})),define("Pages/MixAndMatch",["ko","ProductUtils/ComponentLoader","Asos.Utils.MediaPlayers","ProductUtils/StockPrice","Models/VariantDecorator","Components/product-image/product-image","Components/product-price/product-price","Components/add-item/add-item","Components/content/content","Components/size-guide/size-guide","Components/mix-and-match/mix-and-match","Components/product-gallery/product-gallery","Components/product-colour/product-colour","Components/product-size/product-size","Components/add-item/add-item","PageConfig","ProductUtils/NewRelicLogger","ProductUtils/ScrollTo","ProductUtils/Performance"],(function(a,c,d,ee,te,ie,ne,se,re,oe,ae,ce,le,de,ue,he,pe){return this.init=function(){pe.init(pe.PAGE_TYPE.GRP);var se=window.asos.pdp.config.product,re=window.asos.pdp.config.translations;this.state={resources:re,features:window.asos.pdp.config.features,selectedColour:a.observable(),showNoSizesSelectedWarning:a.observable(!1),focusColourSelect:a.observable(!1),focusSizeSelect:a.observable(!1),preventFocusScroll:a.observable(!1),showAddToBagError:a.observable(!1),addToBagErrorMessage:a.observable(""),sizeGuideOpened:a.observable(!1)},this.isMobile="mobile"===he.platform;var me=this.state,fe=new c,ge="string"==typeof se?JSON.parse(se):se;ge||pe.logError(new Error(pe.ERROR_TYPE.ParseError),{action:"PageInit",message:"server-side product data missing or invalid"});var ve=new ee,be=[],ye=!1,Se=!1;function setProductData(c){for(var d=0;d<c.products.length;d++){var ee={selectedColour:a.observable(),selectedSize:a.observable(),showNoColourSelectedWarning:a.observable(!1),showNoSizeSelectedWarning:a.observable(!1),focusColourSelect:a.observable(!1),focusSizeSelect:a.observable(!1),preventFocusScroll:a.observable(!1),showAddToBagError:a.observable(!1),addToBagErrorMessage:a.observable(""),productImage:c.products[d].productImage.url,resources:re,sizeGuideOpened:me.sizeGuideOpened,session:me.session};c.products[d].brandName=se.brandName,ee.productData=(new te).getData(c.products[d],!0),be.push(ee)}ge.States=be,fe.register({type:"content",name:"content1",elementId:"aside-content",useComponentTemplate:!1},ge,me),Se=!0}function registerComponents(){ye||(window.asos.eventBus.addListener("productAndPriceData",(function(a){Se||setProductData(a)})),function getStockPrice(){return ve.getStockPrice(ge,setProductData,(function(){})),getStockPrice}(),fe.register({type:"content",name:"content3",elementId:"gallery-content",useComponentTemplate:!1},ge,this.state),a.components.register("product-gallery",ce),a.components.register("size-guide",oe),a.components.register("product-image",ie),a.components.register("product-colour",le),a.components.register("product-size",de),a.components.register("product-price",ne),a.components.register("mix-and-match",ae),a.components.register("asos-video-player-prod",d.videoPlayer),a.components.register("asos-spin-viewer-prod",d.spinViewer),a.components.register("add-item",ue),ye=!0,window.asos.pdp.koComponents=fe,window.asos.pdp.koState=me,window.asos.eventBus.emit("knockoutInitialised",fe,me))}document.addEventListener("DOMContentLoaded",function(){registerComponents.call(this)}.bind(this)),document.getElementById("aside-content")&&document.getElementById("gallery-content")&&registerComponents.call(this)},this.init})),window.location.href.includes("/grp/")&&require(["Pages/MixAndMatch"],(function(a){a()})),define("PageConfig",(function(){var a=window.asos.webContext.getWebContext();return{storeCode:a.storeId,countryCode:a.browseCountry,geoCountryCode:a.geoCountry,currency:a.browseCurrency,language:a.browseLanguage,languageShort:a.browseLanguage.substring(0,2),sizeSchema:a.browseSizeSchema,keyStoreDataversion:a.keyStoreDataversion,siteChromeTemplateVersion:a.templateVersion,siteChromeTemplateBuild:a.buildVersion,gender:a.floor,siteDomain:window.asos.pdp.config.siteDomain,platform:a.platform,storeId:a.storeId,pageTitle:document.title,version:window.asos.pdp.config.appVersion,pageType:window.location.href.includes("/prd/")?"product":"mix&match",useTestFeaturesManifest:window.asos.pdp.config.useTestFeaturesManifest,imagePresets:JSON.parse(window.asos.pdp.config.imagePresets)}})),define("Promise",(function(){return Promise})),define("main",["Pages/FullProduct","Pages/MixAndMatch"],(function(){}));